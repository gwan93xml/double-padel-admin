import{r as n,j as t}from"./app-CQ-G37p-.js";import{D as N,a as A,b as B,c as C,d as U}from"./dialog-CBBIkam9.js";import{B as b}from"./button-ymMXdPy5.js";import{I as H}from"./input-BXXA-PDa.js";import{T as L}from"./textarea-BvykTLwI.js";import{F as s}from"./form-group-CHZXn8bM.js";import{S as M}from"./SearchItem-DGpcvLrN.js";import{S as O}from"./SearchSubUnit-CTrUekdR.js";import{M as F}from"./money-input-Bb590VQ4.js";import"./index-BHS3gC_j.js";import"./index-B9C1SM0Q.js";import"./index-DqZ46QiR.js";import"./index-D0iIn24t.js";import"./tslib.es6-eMSY344_.js";import"./index-uJ2KZHf0.js";import"./createLucideIcon-iWXofaGH.js";import"./x-D2Pel9EU.js";import"./label-Blk7FhF1.js";import"./card-Bq41eL_q.js";import"./badge-CsIJHFj0.js";import"./loader-circle-i2ANfqrZ.js";import"./search-B9EA-nRY.js";import"./package-Cd0mGsRo.js";import"./select-BSIJzAmS.js";import"./index-C7S3ohsj.js";import"./index-B9VoEdXn.js";import"./index-CZ_DqijM.js";import"./chevron-down-BOk5s691.js";function he({show:c,isEdit:v,item:r,errors:i,warehouseId:T,onClose:h,onSave:f,onItemChange:_,onQuantityChange:I,onUnitChange:S,onPriceChange:q,onRemarksChange:w,onTotalChange:l,onFocusQuantity:G}){var j,D,k,R,E;const m=n.useRef(null),g=n.useRef(null),a=n.useRef(null),o=n.useRef(null),p=n.useRef(null),d=n.useRef(null),K=n.useRef(null),y=n.useRef(!1);return n.useEffect(()=>{c&&setTimeout(()=>{m.current&&m.current.focus()},150)},[c]),n.useEffect(()=>{r.item_id&&(y.current=!0,setTimeout(()=>{y.current=!1},800))},[r.item_id]),n.useEffect(()=>{const e=parseFloat(r.quantity||"0"),u=parseFloat(r.price||"0"),x=e*u;!isNaN(x)&&x!==parseFloat(r.total||"0")&&(l==null||l(x.toString()))},[r.quantity,r.price,r.total,l]),n.useEffect(()=>{const e=u=>{(u.key==="Enter"||u.key===" ")&&a.current&&(a.current===document.activeElement||a.current.contains(document.activeElement))};if(c)return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[c]),t.jsx(N,{open:c,onOpenChange:h,children:t.jsxs(A,{className:"max-h-[80vh] overflow-y-auto",children:[t.jsx(B,{children:t.jsx(C,{children:v?"Edit Item":"Tambahkan Item"})}),t.jsx("form",{onSubmit:e=>e.preventDefault(),children:t.jsxs("div",{className:"space-y-4",children:[t.jsx(s,{label:"Item",error:i.item_id,name:"item_id",children:t.jsx(M,{itemCodeRef:m,warehouseId:T,value:{id:r.item_id??"",code:((j=r.item)==null?void 0:j.code)??"",name:((D=r.item)==null?void 0:D.name)??"",purchase_price:String(((k=r.item)==null?void 0:k.purchase_price)??"0"),selling_price:String(((R=r.item)==null?void 0:R.selling_price)??"0"),unit:((E=r.item)==null?void 0:E.unit)??""},onChange:e=>{_(e)},nextRef:g})}),t.jsx(s,{label:"Jumlah",error:i.quantity,name:"quantity",children:t.jsx(H,{ref:g,type:"number",value:r.quantity,className:"text-right",onFocus:e=>{e.target.select()},onChange:e=>I(e.target.value),onKeyDown:e=>{e.key==="Enter"&&(e.preventDefault(),a.current&&setTimeout(()=>{a.current.focus()},50))}})}),t.jsx(s,{label:"Satuan",error:i.unit,required:!0,children:t.jsx(O,{ref:a,value:r.unit,itemId:r.item_id,onChange:e=>{e!==""&&(S(e),y.current||setTimeout(()=>{o.current&&(o.current.focus(),o.current.select())},200))}})}),t.jsx(s,{label:"Harga",error:i.price,name:"price",children:t.jsx(F,{ref:o,value:r.price,onFocus:e=>{setTimeout(()=>{e.target.select()},10)},onValueChange:e=>q(e),onKeyDown:e=>{e.key==="Enter"?(e.preventDefault(),p.current&&p.current.focus()):e.key==="ArrowUp"&&a.current&&(e.preventDefault(),a.current.focus())}})}),t.jsx(s,{label:"Total",error:i.total,name:"total",children:t.jsx(F,{ref:p,value:r.total||"0",readOnly:!0,onFocus:e=>{setTimeout(()=>{e.target.select()},10)},onKeyDown:e=>{e.key==="Enter"?(e.preventDefault(),d.current&&d.current.focus()):e.key==="ArrowUp"&&o.current&&(e.preventDefault(),o.current.focus(),setTimeout(()=>{var u;return(u=o.current)==null?void 0:u.select()},0))}})}),t.jsx(s,{label:"Keterangan",error:i.remarks,name:"remarks",children:t.jsx(L,{ref:d,value:r.remarks,onChange:e=>w(e.target.value),onKeyDown:e=>{e.key==="Enter"&&!e.shiftKey?(e.preventDefault(),f()):e.key==="ArrowUp"&&o.current&&(o.current.focus(),setTimeout(()=>{var u;return(u=o.current)==null?void 0:u.select()},0))},onFocus:e=>{setTimeout(()=>{e.target.setSelectionRange(e.target.value.length,e.target.value.length)},0)}})})]})}),t.jsxs(U,{children:[t.jsx(b,{type:"button",variant:"outline",onClick:h,children:"Batal"}),t.jsx(b,{ref:K,type:"button",onClick:()=>{f()},onKeyDown:e=>{e.key==="Enter"&&(e.preventDefault(),f())},children:v?"Edit":"Tambah"})]})]})})}export{he as default};
