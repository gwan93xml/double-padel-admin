import{r,j as e,a as N}from"./app-CQ-G37p-.js";import{B as h}from"./button-ymMXdPy5.js";import{I as p}from"./input-BXXA-PDa.js";import{D as I,a as R,b as A,c as F}from"./dialog-CBBIkam9.js";import{T as L,a as G,b as w,c as a,d as M}from"./table-BSdxGOLt.js";import{h as Y}from"./moment-C5S46NFB.js";import{C as H}from"./currency-formatter-D5vTOkIG.js";import{S as g}from"./search-B9EA-nRY.js";import{F as $}from"./folder-BoHnSs8n.js";function X({onChange:y,value:t,vendorId:S}){const[o,c]=r.useState({id:"",number:""}),[d,u]=r.useState(!1),[x,l]=r.useState(""),v=r.useRef(!1);r.useRef(t),r.useEffect(()=>{t&&c({id:t.id||"",number:t.number||""})},[]),r.useEffect(()=>{y(o)},[o]);const C=s=>{c({...o,number:s.target.value}),l("")},j=async s=>{if(s.trim()){u(!0),l("");try{const{data:n}=await N.get(`/admin/purchase-order/search-by-number?search=${s}`);n.data?(v.current=!0,c({id:n.data.id,number:n.data.number})):l("Purchase order not found")}catch(n){l("Failed to search purchase order"),console.error(n)}finally{u(!1)}}},B=s=>{s.key==="Enter"&&j(o.number)},D=()=>{o.number&&j(o.number)},[O,i]=r.useState(!1),[f,T]=r.useState(""),[E,P]=r.useState([]),k=()=>{i(!0),m()},m=async()=>{try{const s=await N.get(`/admin/purchase-order/list?search=${f}&vendor_id=${S}`);P(s.data.data)}catch(s){console.error(s)}};return r.useEffect(()=>{m()},[]),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-full",children:e.jsx(p,{className:"rounded-r-none",placeholder:"Nomor Purchase Order",value:o.number,onChange:C,onKeyDown:B,disabled:d})}),e.jsxs("div",{className:"flex",children:[e.jsx(h,{className:"rounded-none",onClick:D,disabled:d,children:e.jsx(g,{className:"h-4 w-4"})}),e.jsx(h,{className:"rounded-none",onClick:k,disabled:d,children:e.jsx($,{className:"h-4 w-4"})})]})]}),d&&e.jsx("div",{className:"text-sm text-muted-foreground",children:"Searching..."}),x&&e.jsx("div",{className:"text-sm text-destructive",children:x}),e.jsx(I,{open:O,onOpenChange:i,children:e.jsxs(R,{className:"min-w-[70%]",children:[e.jsx(A,{children:e.jsx(F,{children:"Browse Sales Order"})}),e.jsxs("div",{className:"flex",children:[e.jsx(p,{className:"rounded-r-none",value:f,onChange:s=>T(s.target.value)}),e.jsx(h,{className:"rounded-l-none",onClick:m,children:e.jsx(g,{className:"h-4 w-4"})})]}),e.jsxs(L,{children:[e.jsx(G,{children:e.jsxs(w,{children:[e.jsx(a,{children:"NOMOR"}),e.jsx(a,{children:"NOMOR PO"}),e.jsx(a,{children:"DIVISI"}),e.jsx(a,{children:"TANGGAL"}),e.jsx(a,{children:"PELANGGAN"}),e.jsx(a,{children:"TOTAL"})]})}),e.jsx(M,{children:E.map(s=>{var n,b;return e.jsxs(w,{onClick:()=>{c(s),i(!1)},className:"cursor-pointer hover:bg-muted",children:[e.jsx(a,{children:s.number}),e.jsx(a,{children:(n=s.division)==null?void 0:n.name}),e.jsx(a,{children:Y(s.date).format("DD/MM/YYYY")}),e.jsx(a,{children:(b=s.vendor)==null?void 0:b.name}),e.jsx(a,{children:e.jsx(H,{amount:parseFloat(s.total??"0")})})]},s.id)})})]})]})})]})}export{X as S};
