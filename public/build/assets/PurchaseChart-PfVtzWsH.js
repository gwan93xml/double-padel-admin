import{r as t,j as a,a as B}from"./app-xdIDsNuc.js";import{c as R}from"./utils-jM7Hu9J5.js";import{B as H}from"./index-D9fYs-5N.js";import{s as f,P as O,a as A,f as l,b as I,C as _,c as E,d as K,e as $}from"./popover-BcYesNQU.js";import{C as c,a as m,b as d,c as h,d as z}from"./card-DPe-xeUS.js";import{S as G,a as J,b as V,c as X,d as q}from"./select-CnbTIwKL.js";import{a as L,h as j}from"./moment-DPfounic.js";import{R as Q,B as U,C as W,X as Z,Y as aa,a as ea}from"./BarChart-YJFtQliD.js";import"./chevron-left-BAjotGkp.js";import"./createLucideIcon-D9qBrcbq.js";import"./index-CltWYr8P.js";import"./index-Dy_V4ZJ5.js";import"./index-4rFdga_w.js";import"./index-CCSo0cdO.js";import"./index-CZTB0vk4.js";import"./index-DY1xKekZ.js";import"./check-B2a_CU3u.js";const sa=[{value:"7d",label:"7 Hari Terakhir"},{value:"30d",label:"30 Hari Terakhir"},{value:"90d",label:"90 Hari Terakhir"},{value:"6m",label:"6 Bulan Terakhir"},{value:"custom",label:"Kustom"}];function ga(){const[n,b]=t.useState("30d"),[s,y]=t.useState({from:f(new Date,30),to:new Date}),[g,x]=t.useState(!1),[u,C]=t.useState([]),i=e=>new Intl.NumberFormat("id-ID").format(e),[M,v]=t.useState(0),[S,w]=t.useState(0),[D,N]=t.useState(0),k=e=>{b(e),e!=="custom"&&x(!1)};return t.useEffect(()=>{async function e(){const{data:P}=await B.get("/admin/purchase/chart",{params:{time_range:n,start_date:j(s.from).format("YYYY-MM-DD"),end_date:j(s.to).format("YYYY-MM-DD")}}),o=P.data.map(r=>({date:r.date,purchases:parseFloat(r.purchases)})),p=o.reduce((r,F)=>r+parseFloat(F.purchases),0),T=p/o.length,Y=Math.max(...o.map(r=>r.purchases));v(p),w(T),N(Y),C(o)}e()},[n,s]),a.jsxs(c,{children:[a.jsx(m,{className:"pb-4",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[a.jsxs("div",{children:[a.jsx(d,{children:"Grafik Pembelian"}),a.jsx(h,{children:"Analisis pembelian berdasarkan rentang waktu"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[a.jsxs(G,{value:n,onValueChange:k,children:[a.jsx(J,{className:"w-[180px]",children:a.jsx(V,{placeholder:"Pilih rentang waktu"})}),a.jsx(X,{children:sa.map(e=>a.jsx(q,{value:e.value,children:e.label},e.value))})]}),n==="custom"&&a.jsxs(O,{open:g,onOpenChange:x,children:[a.jsx(A,{asChild:!0,children:a.jsxs(H,{variant:"outline",className:R("w-[280px] justify-start text-left font-normal",!s&&"text-muted-foreground"),children:[a.jsx(L,{className:"mr-2 h-4 w-4"}),s!=null&&s.from?s.to?a.jsxs(a.Fragment,{children:[l(s.from,"dd/MM/yyyy")," - ",l(s.to,"dd/MM/yyyy")]}):l(s.from,"dd/MM/yyyy"):a.jsx("span",{children:"Pilih tanggal"})]})}),a.jsx(I,{className:"w-auto p-0",align:"start",children:a.jsx(_,{initialFocus:!0,mode:"range",defaultMonth:s==null?void 0:s.from,selected:s,onSelect:e=>{y({from:(e==null?void 0:e.from)||f(new Date,30),to:(e==null?void 0:e.to)||new Date})},numberOfMonths:2})})]})]})]})}),a.jsxs(z,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[a.jsx(c,{className:"mb-6",children:a.jsxs(m,{className:"pb-2",children:[a.jsx(h,{children:"Total Pembelian"}),a.jsx(d,{className:"text-xl",children:i(M)})]})}),a.jsx(c,{className:"mb-6",children:a.jsxs(m,{className:"pb-2",children:[a.jsx(h,{children:"Rata-rata Harian"}),a.jsx(d,{className:"text-xl",children:i(S)})]})}),a.jsx(c,{className:"mb-6",children:a.jsxs(m,{className:"pb-2",children:[a.jsx(h,{children:"Pembelian Tertinggi"}),a.jsx(d,{className:"text-xl",children:i(D)})]})})]}),a.jsx("div",{className:"min-h-[300px]",children:a.jsx(E,{config:{purchases:{label:"Pembelian",color:"hsl(var(--chart-1))"}},children:a.jsx(Q,{width:"100%",height:"100%",children:a.jsxs(U,{data:u,margin:{top:10,right:30,left:0,bottom:0},children:[a.jsx(W,{strokeDasharray:"3 3",vertical:!1}),a.jsx(Z,{dataKey:"date",tickFormatter:e=>u.length>30?l(new Date(e),"dd/MM"):l(new Date(e),"dd/MM/yyyy"),tick:{fontSize:12},tickMargin:0}),a.jsx(aa,{tickFormatter:e=>`${i(e/1e6)}Jt`,tick:{fontSize:12},tickMargin:0}),a.jsx(K,{content:a.jsx($,{formatter:e=>`${i(e/1e6)}Jt`,labelFormatter:e=>l(new Date(e),"dd MMMM yyyy")})}),a.jsx(ea,{dataKey:"purchases",fill:"blue",radius:[4,4,0,0]})]})})})})]})]})}export{ga as default};
