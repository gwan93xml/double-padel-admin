import{r as l,j as t}from"./app-CQ-G37p-.js";import{S as E}from"./SearchChartOfAccount-0Jd4yGJY.js";import{S as q}from"./SearchItem-DGpcvLrN.js";import{S as I}from"./SearchItemNonStock-BQ2Ydllm.js";import{S as K}from"./SearchSubUnit-CTrUekdR.js";import{B as C}from"./button-ymMXdPy5.js";import{D as T,a as A,b as B,c as O,d as V}from"./dialog-CBBIkam9.js";import{F as s}from"./form-group-CHZXn8bM.js";import{I as a}from"./input-BXXA-PDa.js";import{M as u}from"./money-input-Bb590VQ4.js";import{T as H}from"./textarea-BvykTLwI.js";import"./card-Bq41eL_q.js";import"./createLucideIcon-iWXofaGH.js";import"./badge-CsIJHFj0.js";import"./loader-circle-i2ANfqrZ.js";import"./search-B9EA-nRY.js";import"./x-D2Pel9EU.js";import"./file-text-vhY6aTSF.js";import"./package-Cd0mGsRo.js";import"./select-BSIJzAmS.js";import"./index-B9C1SM0Q.js";import"./index-DqZ46QiR.js";import"./index-D0iIn24t.js";import"./tslib.es6-eMSY344_.js";import"./index-C7S3ohsj.js";import"./index-B9VoEdXn.js";import"./index-CZ_DqijM.js";import"./chevron-down-BOk5s691.js";import"./index-BHS3gC_j.js";import"./index-uJ2KZHf0.js";import"./label-Blk7FhF1.js";function je({formDialog:m,data:e,setData:r,errors:i,onSave:x,onOpenChange:h,warehouse_id:N}){var k,R,S,v;l.useRef(null);const p=l.useRef(null),g=l.useRef(null),j=l.useRef(null),f=l.useRef(null),_=l.useRef(null),b=l.useRef(null),d=l.useRef(null);l.useRef(null);const y=l.useRef(null),F=l.useRef(null);return t.jsx(T,{open:m.open,onOpenChange:h,children:t.jsxs(A,{className:" max-h-[80vh] overflow-y-auto",children:[t.jsx(B,{children:t.jsx(O,{children:m.isEdit?"Edit Item":"Tambahkan item"})}),t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex border border-gray-200 shadow-sm rounded justify-stretch",children:[t.jsx("div",{className:`flex-1 p-2 text-center border-r cursor-pointer font-bold " ${e.is_stock?"bg-blue-600 rounded-l text-white":""}`,onClick:()=>{r({...e,is_stock:!0})},children:"STOCK"}),t.jsx("div",{className:`flex-1 p-2 text-center cursor-pointer font-bold ${e.is_stock?"":"bg-blue-600 rounded-r text-white"}`,onClick:()=>{r({...e,is_stock:!1})},children:"NON STOCK"})]}),e.is_stock?t.jsx(s,{label:"Item",error:i.item_name,name:"item_id",required:!0,children:t.jsx(q,{nextRef:p,warehouseId:N,value:{id:e.item_id??"",code:((k=e.item)==null?void 0:k.code)??"",name:((R=e.item)==null?void 0:R.name)??"",purchase_price:(e==null?void 0:e.price)??"0",selling_price:(e==null?void 0:e.price)??"0",unit:(e==null?void 0:e.unit)??"",description:e.notes??""},onChange:n=>{r({...e,item_id:n.id,item_name:n.name,price:n.selling_price??0,unit:"",item:{code:n.code,name:n.name},notes:n.description})}})}):null,!e.is_stock&&t.jsxs(t.Fragment,{children:[t.jsx(s,{label:"Item Non Stock",error:i.item_name,name:"item_name",required:!0,children:t.jsx(I,{value:{id:e.item_id??"",item_name:e.item_name??"",price:(e==null?void 0:e.price)??"0",unit:(e==null?void 0:e.unit)??"",description:e.notes},onChange:n=>{r({...e,item_id:n.id,item_name:n.item_name,price:n.price??0,item:{code:n.code,name:n.name},notes:n.description,unit:n.unit??""})},nextRef:y,source:"sale"})}),t.jsx(s,{label:"Akun",error:i.chart_of_account_id,name:"chart_of_account_id",children:t.jsx(E,{accountCodeRef:y,nextRef:p,value:{id:e.chart_of_account_id,code:(S=e.chart_of_account)==null?void 0:S.code,name:(v=e.chart_of_account)==null?void 0:v.name},onChange:n=>{r({...e,chart_of_account_id:n.id,chart_of_account:n})}})})]}),t.jsx(s,{label:"Harga",error:i.price,name:"price",children:t.jsx(u,{ref:p,value:e.price,onValueChange:n=>{r({...e,price:n,subtotal:(parseFloat(n)*parseFloat(e.quantity??"1")).toString(),total:(parseFloat(n)*parseFloat(e.quantity??"1")-parseFloat(e.discount??"0")).toString()})},onKeyDown:n=>{var o;n.key==="Enter"&&((o=g.current)==null||o.focus())}})}),t.jsx(s,{label:"Jumlah",error:i.quantity,name:"quantity",children:t.jsx(a,{ref:g,type:"number",value:e.quantity,onFocus:n=>{n.target.select()},className:"text-right",onChange:n=>{r({...e,quantity:n.target.value,subtotal:(parseFloat(e.price??"0")*parseFloat(n.target.value)).toString(),total:(parseFloat(e.price??"0")*parseFloat(n.target.value)-parseFloat(e.discount??"0")).toString()})},onKeyDown:n=>{var o,c;n.key==="Enter"&&(e.is_stock?(o=j.current)==null||o.focus():(c=F.current)==null||c.focus())}})}),e.is_stock?t.jsx(s,{label:"Satuan",error:i.unit,required:!0,children:t.jsx(K,{ref:j,value:e.unit,itemId:e.item_id,onChange:n=>{r("unit",n),setTimeout(()=>{var o;(o=f.current)==null||o.focus()},100)}})}):t.jsx(s,{label:"Satuan",error:i.unit,name:"unit",children:t.jsx(a,{ref:F,type:"text",value:e.unit,onChange:n=>{r({...e,unit:n.target.value})},onKeyDown:n=>{var o;n.key==="Enter"&&((o=f.current)==null||o.focus())}})}),t.jsx(s,{label:"Subtotal",error:i.subtotal,name:"subtotal",children:t.jsx(u,{ref:f,value:e.subtotal,className:"text-right",onValueChange:n=>{r({...e,subtotal:n,total:(parseFloat(n)-parseFloat(e.discount??"0")).toString(),price:(parseFloat(n)/parseFloat(e.quantity??"1")).toString()})},onKeyDown:n=>{var o;n.key==="Enter"&&((o=_.current)==null||o.focus())}})}),t.jsxs("div",{className:"flex",children:[t.jsx("div",{className:"w-3/4",children:t.jsx(s,{label:"Discount",error:i.discount,name:"discount",children:t.jsx(u,{ref:_,value:e.discount,className:"text-right",onValueChange:n=>{r({...e,discount:n,discount_percent:0,total:(parseFloat(e.subtotal)-parseFloat(n)).toString()})},onKeyDown:n=>{var o;n.key==="Enter"&&((o=b.current)==null||o.focus())}})})}),t.jsx("div",{className:"w-1/4",children:t.jsx(s,{label:"%",error:i.discount,name:"discount",children:t.jsx(a,{type:"number",value:e.discount_percent,className:"text-right",ref:b,onFocus:n=>{n.target.select()},onChange:n=>{const o=parseFloat(e.subtotal??"0"),c=(o*parseFloat(n.target.value)/100).toFixed(2),w=(o-parseFloat(c)).toFixed(2);r({...e,discount_percent:n.target.value,discount:c,total:w})},onKeyDown:n=>{var o;n.key==="Enter"&&((o=d.current)==null||o.focus())}})})})]}),t.jsx(s,{label:"Total",error:i.total,name:"total",children:t.jsx(u,{disabled:!0,value:e.total,className:"text-right"})}),t.jsx(s,{label:"Catatan",error:i.notes,name:"notes",children:t.jsx(H,{ref:d,value:e.notes,onChange:n=>{r({...e,notes:n.target.value})},onKeyDown:n=>{n.key==="Enter"&&x(!0)}})})]}),t.jsxs(V,{children:[t.jsx(C,{type:"button",variant:"outline",onClick:h,children:"Batal"}),t.jsx(C,{type:"button",onClick:()=>x(!1),children:m.isEdit?"Edit":"Tambah"})]})]})})}export{je as default};
