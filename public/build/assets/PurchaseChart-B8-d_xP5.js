import{r as t,j as a,a as B}from"./app-CQ-G37p-.js";import{c as R}from"./createLucideIcon-iWXofaGH.js";import{B as H}from"./button-ymMXdPy5.js";import{s as f,C as O,a as A,R as I,B as _,b as E,X as K,Y as $,c as z,d as G,e as J}from"./chart-D1U1NzDA.js";import{C as c,a as m,b as d,c as h,d as V}from"./card-Bq41eL_q.js";import{P as X,a as q,b as L}from"./popover-BMGWAYFn.js";import{S as Q,a as U,b as W,c as Z,d as aa}from"./select-BSIJzAmS.js";import{h as j}from"./moment-C5S46NFB.js";import{C as ea}from"./calendar-BV_-Gsoc.js";import{f as l}from"./format-DzEUF7Jh.js";import"./index-D0iIn24t.js";import"./index-Dhyve51-.js";import"./chevron-right-DWL5tPD-.js";import"./index-B9C1SM0Q.js";import"./index-DqZ46QiR.js";import"./tslib.es6-eMSY344_.js";import"./index-C7S3ohsj.js";import"./index-B9VoEdXn.js";import"./index-uJ2KZHf0.js";import"./index-CZ_DqijM.js";import"./chevron-down-BOk5s691.js";const sa=[{value:"7d",label:"7 Hari Terakhir"},{value:"30d",label:"30 Hari Terakhir"},{value:"90d",label:"90 Hari Terakhir"},{value:"6m",label:"6 Bulan Terakhir"},{value:"custom",label:"Kustom"}];function Sa(){const[n,b]=t.useState("30d"),[s,y]=t.useState({from:f(new Date,30),to:new Date}),[g,x]=t.useState(!1),[p,C]=t.useState([]),i=e=>new Intl.NumberFormat("id-ID").format(e),[M,v]=t.useState(0),[S,w]=t.useState(0),[D,N]=t.useState(0),k=e=>{b(e),e!=="custom"&&x(!1)};return t.useEffect(()=>{async function e(){const{data:P}=await B.get("/admin/purchase/chart",{params:{time_range:n,start_date:j(s.from).format("YYYY-MM-DD"),end_date:j(s.to).format("YYYY-MM-DD")}}),o=P.data.map(r=>({date:r.date,purchases:parseFloat(r.purchases)})),u=o.reduce((r,F)=>r+parseFloat(F.purchases),0),T=u/o.length,Y=Math.max(...o.map(r=>r.purchases));v(u),w(T),N(Y),C(o)}e()},[n,s]),a.jsxs(c,{children:[a.jsx(m,{className:"pb-4",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[a.jsxs("div",{children:[a.jsx(d,{children:"Grafik Pembelian"}),a.jsx(h,{children:"Analisis pembelian berdasarkan rentang waktu"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[a.jsxs(Q,{value:n,onValueChange:k,children:[a.jsx(U,{className:"w-[180px]",children:a.jsx(W,{placeholder:"Pilih rentang waktu"})}),a.jsx(Z,{children:sa.map(e=>a.jsx(aa,{value:e.value,children:e.label},e.value))})]}),n==="custom"&&a.jsxs(X,{open:g,onOpenChange:x,children:[a.jsx(q,{asChild:!0,children:a.jsxs(H,{variant:"outline",className:R("w-[280px] justify-start text-left font-normal",!s&&"text-muted-foreground"),children:[a.jsx(ea,{className:"mr-2 h-4 w-4"}),s!=null&&s.from?s.to?a.jsxs(a.Fragment,{children:[l(s.from,"dd/MM/yyyy")," - ",l(s.to,"dd/MM/yyyy")]}):l(s.from,"dd/MM/yyyy"):a.jsx("span",{children:"Pilih tanggal"})]})}),a.jsx(L,{className:"w-auto p-0",align:"start",children:a.jsx(O,{initialFocus:!0,mode:"range",defaultMonth:s==null?void 0:s.from,selected:s,onSelect:e=>{y({from:(e==null?void 0:e.from)||f(new Date,30),to:(e==null?void 0:e.to)||new Date})},numberOfMonths:2})})]})]})]})}),a.jsxs(V,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[a.jsx(c,{className:"mb-6",children:a.jsxs(m,{className:"pb-2",children:[a.jsx(h,{children:"Total Pembelian"}),a.jsx(d,{className:"text-xl",children:i(M)})]})}),a.jsx(c,{className:"mb-6",children:a.jsxs(m,{className:"pb-2",children:[a.jsx(h,{children:"Rata-rata Harian"}),a.jsx(d,{className:"text-xl",children:i(S)})]})}),a.jsx(c,{className:"mb-6",children:a.jsxs(m,{className:"pb-2",children:[a.jsx(h,{children:"Pembelian Tertinggi"}),a.jsx(d,{className:"text-xl",children:i(D)})]})})]}),a.jsx("div",{className:"min-h-[300px]",children:a.jsx(A,{config:{purchases:{label:"Pembelian",color:"hsl(var(--chart-1))"}},children:a.jsx(I,{width:"100%",height:"100%",children:a.jsxs(_,{data:p,margin:{top:10,right:30,left:0,bottom:0},children:[a.jsx(E,{strokeDasharray:"3 3",vertical:!1}),a.jsx(K,{dataKey:"date",tickFormatter:e=>p.length>30?l(new Date(e),"dd/MM"):l(new Date(e),"dd/MM/yyyy"),tick:{fontSize:12},tickMargin:0}),a.jsx($,{tickFormatter:e=>`${i(e/1e6)}Jt`,tick:{fontSize:12},tickMargin:0}),a.jsx(z,{content:a.jsx(G,{formatter:e=>`${i(e/1e6)}Jt`,labelFormatter:e=>l(new Date(e),"dd MMMM yyyy")})}),a.jsx(J,{dataKey:"purchases",fill:"blue",radius:[4,4,0,0]})]})})})})]})]})}export{Sa as default};
