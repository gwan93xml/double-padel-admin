import{r as j,j as s}from"./app-CQ-G37p-.js";import{A as b}from"./auto-manual-toggle-Drq7Gsew.js";import{B as _}from"./button-ymMXdPy5.js";import{D as v,a as y}from"./dialog-CBBIkam9.js";import{F as f}from"./form-group-CHZXn8bM.js";import{I as F}from"./input-BXXA-PDa.js";import{M as r}from"./money-input-Bb590VQ4.js";import{l as c}from"./lodash-Caeo88pO.js";import{P as O}from"./pencil-XLeJOTln.js";import"./createLucideIcon-iWXofaGH.js";import"./settings-BIxmfjj-.js";import"./index-D0iIn24t.js";import"./index-BHS3gC_j.js";import"./index-B9C1SM0Q.js";import"./index-DqZ46QiR.js";import"./tslib.es6-eMSY344_.js";import"./index-uJ2KZHf0.js";import"./x-D2Pel9EU.js";import"./label-Blk7FhF1.js";function G({data:t,type_ofTax:u,setData:n}){var p,h;const[g,x]=j.useState(!1);j.useEffect(()=>{var e,o;if(t.tax_is_auto)if(u){const l=c.sum(((e=t.items)==null?void 0:e.map(m=>parseFloat(m.subtotal??"0")))??[]),i=c.sum(((o=t.items)==null?void 0:o.map(m=>parseFloat(m.discount??"0")))??[]),a=(l-i-Number(t.purchase_discount))*parseFloat(u.rate??"0")/100;n("tax",Math.round(a))}else n("tax",0)},[u,JSON.stringify(t.items),t.tax_is_auto]);function d(){var l,i;const e=c.sum(((l=t.items)==null?void 0:l.map(a=>parseFloat(a.subtotal??"0")))??[]),o=c.sum(((i=t.items)==null?void 0:i.map(a=>parseFloat(a.discount??"0")))??[]);return e-o}function N(){const e=d(),o=Number(t.tax??0),l=Number(t.shipping_cost??"0"),i=Number(t.stamp_duty??"0");return e+o+l+i-Number(t.purchase_discount??"0")-(t.total_retur??0)}return s.jsxs(s.Fragment,{children:[s.jsx("table",{className:"w-full",children:s.jsxs("tbody",{children:[s.jsxs("tr",{children:[s.jsx("td",{className:"text-right font-semibold font-mono",children:"SUBTOTAL"}),s.jsx("td",{className:"text-right w-4/5 md:w-1/5 pl-8 font-bold",children:s.jsx(r,{readOnly:!0,value:c.sum(((p=t.items)==null?void 0:p.map(e=>parseFloat(e.subtotal??"0")))??[]).toFixed(2)})})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"text-right font-semibold font-mono",children:"DISKON"}),s.jsx("td",{className:"text-right font-bold pl-8",children:s.jsx(r,{readOnly:!0,value:c.sum(((h=t.items)==null?void 0:h.map(e=>parseFloat(e.discount??"0")))??[]).toFixed(2)})})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"text-right font-mono font-semibold",children:"DISKON PEMBELIAN"}),s.jsx("td",{className:"text-right font-bold pl-8",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-3/5",children:s.jsx(r,{value:t.purchase_discount,onValueChange:e=>{n({...t,purchase_discount:e,purchase_discount_percent:0})}})}),s.jsx("div",{children:s.jsx("span",{className:"mx-2",children:"%"})}),s.jsx("div",{className:"w-2/5",children:s.jsx(F,{type:"number",className:"text-end",value:t.purchase_discount_percent,onChange:e=>{const o=parseFloat(e.target.value)||0,i=d()*o/100;n({...t,purchase_discount:i.toFixed(2),purchase_discount_percent:o})}})})]})})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"text-right font-semibold font-mono",children:"PAJAK"}),s.jsx("td",{className:"text-right pl-4",children:s.jsxs("div",{className:"flex",children:[s.jsx(b,{isAuto:t.tax_is_auto,onToggle:e=>{n("tax_is_auto",e)}}),s.jsx(r,{value:t.tax,readOnly:t.tax_is_auto,className:" m-0 font-bold",onValueChange:e=>{n("tax",e)}})]})})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"text-right",children:s.jsxs(_,{type:"button",size:"sm",onClick:()=>{x(!0)},className:"text-right",children:[s.jsx(O,{size:24,className:"inline-block"}),s.jsx("span",{className:"font-bold font-mono",children:"ADJ"})]})}),s.jsx("td",{className:"text-right pl-8 font-bold",children:s.jsx(r,{readOnly:!0,value:(Number(t.shipping_cost??0)+Number(t.stamp_duty??0)).toFixed(2)})})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"text-right font-bold font-mono",children:"Total Retur"}),s.jsx("td",{className:"text-right font-bold pl-8",children:s.jsx(r,{readOnly:!0,value:t.total_retur})})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"text-right font-bold font-mono",children:"Total"}),s.jsx("td",{className:"text-right font-bold pl-8",children:s.jsx(r,{readOnly:!0,value:N().toFixed(2)})})]})]})}),s.jsx(v,{open:g,onOpenChange:x,children:s.jsx(y,{className:" max-h-[80vh] overflow-y-auto",children:s.jsxs("div",{className:"p-4",children:[s.jsx(f,{label:"Biaya Pengiriman",required:!0,children:s.jsx(r,{value:t.shipping_cost??0,onValueChange:e=>{n({...t,shipping_cost:e})}})}),s.jsx(f,{label:"Biaya Materai",required:!0,children:s.jsx(r,{value:t.stamp_duty??0,onValueChange:e=>{n({...t,stamp_duty:e})}})})]})})})]})}export{G as default};
