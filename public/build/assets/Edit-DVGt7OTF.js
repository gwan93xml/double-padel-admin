import{W as Q,r as M,j as e,a as U,y as W}from"./app-CQ-G37p-.js";import{B as j}from"./button-ymMXdPy5.js";import{C as L}from"./checkbox-DaA1krf_.js";import{C as d,a as N,b as D,c as F,d as x}from"./card-Bq41eL_q.js";import{F as E}from"./form-group-CHZXn8bM.js";import{I as T}from"./input-BXXA-PDa.js";import{L as f}from"./label-Blk7FhF1.js";import{B as y}from"./badge-CsIJHFj0.js";import{A as X,S as J,a as v,b as R}from"./AuthenticatedLayout-X6euxa7E.js";import{t as B}from"./use-toast-XJEkqv7A.js";import{U as O}from"./users-CyDfFij0.js";import{S as V}from"./settings-BIxmfjj-.js";import{F as Y}from"./filter-BZN7rDIQ.js";import{S as Z}from"./save-CHEDKyco.js";import{L as ee}from"./lock-hNhsjlZw.js";import{S as H}from"./search-B9EA-nRY.js";import{X as I}from"./x-D2Pel9EU.js";import{C as _}from"./circle-check-big-DDOzmUMH.js";import"./index-D0iIn24t.js";import"./createLucideIcon-iWXofaGH.js";import"./index-B9C1SM0Q.js";import"./index-DqZ46QiR.js";import"./tslib.es6-eMSY344_.js";import"./index-CZ_DqijM.js";import"./index-B9VoEdXn.js";import"./index-uJ2KZHf0.js";import"./index-BHS3gC_j.js";import"./index-C7S3ohsj.js";import"./can-DARgw7Bo.js";import"./chevron-right-DWL5tPD-.js";import"./currency-formatter-D5vTOkIG.js";import"./moment-C5S46NFB.js";import"./triangle-alert-byTh5Szo.js";import"./calendar-BV_-Gsoc.js";function Re({role:k,modules:h}){const{data:l,setData:c,clearErrors:z,errors:w,setError:K}=Q({...k,permissions:k.permissions.map(s=>`${s.name}`)}),[C,$]=M.useState(!1),[i,S]=M.useState("");async function q(){z(),$(!0);try{const s=await U.put(`/admin/role/${l.id}`,l);B({title:"Sukses",description:"Data role berhasil diubah"}),W.visit("/admin/role")}catch(s){if(s.response.status===422){const r=s.response.data.errors;K(r)}else B({variant:"destructive",title:"Gagal",description:s.response.data.message})}finally{$(!1)}}function A(s,r){const a=r.actions.map(t=>`${t.name}-${r.slug}`);if(s)c("permissions",[...l.permissions,...a]);else{const t=l.permissions.filter(n=>!a.includes(n));c("permissions",t)}}function G(s,r,a){const t=`${r.name}-${a.slug}`;if(s)c("permissions",[...l.permissions,t]);else{const n=l.permissions.filter(b=>b!==`${r.name}-${a.slug}`);c("permissions",n)}}const o=s=>s.actions.map(a=>`${a.name}-${s.slug}`).every(a=>{var t;return(t=l.permissions)==null?void 0:t.includes(a)}),g=s=>s.actions.map(a=>`${a.name}-${s.slug}`).some(a=>{var t;return(t=l.permissions)==null?void 0:t.includes(a)})&&!o(s),p=()=>{var s;return((s=l.permissions)==null?void 0:s.length)||0},u=()=>h.reduce((s,r)=>s+r.actions.length,0),m=h.filter(s=>{const r=s.name.toLowerCase().includes(i.toLowerCase()),a=s.actions.some(t=>t.name.toLowerCase().includes(i.toLowerCase()));return r||a}),P=()=>{S("")};return e.jsx(X,{breadcrumbs:[{label:"Dashboard",href:"/admin"},{label:"Pengaturan",href:"#"},{label:"Role",href:"/admin/role"},{label:"Edit",href:"#"}],children:e.jsxs("div",{className:"p-4 md:p-6 bg-gradient-to-br from-blue-50 to-indigo-50 min-h-screen dark:from-gray-900 dark:to-gray-800",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 bg-blue-600 rounded-lg",children:e.jsx(J,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white ",children:"Edit Role"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-200",children:"Kelola hak akses dan permission untuk role"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-6",children:[e.jsx("div",{className:"xl:col-span-1",children:e.jsxs(d,{className:"shadow-lg border-0 sticky top-6",children:[e.jsxs(N,{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-t-lg",children:[e.jsxs(D,{className:"flex items-center gap-2",children:[e.jsx(O,{className:"h-5 w-5"}),"Informasi Role"]}),e.jsx(F,{className:"text-blue-100",children:"Detail dan statistik role"})]}),e.jsxs(x,{className:"p-6 space-y-6",children:[e.jsx(E,{label:"Nama Role",error:w.name,required:!0,children:e.jsx(T,{type:"text",value:l.name,onChange:s=>c("name",s.target.value),placeholder:"Masukkan nama role",className:"mt-1"})}),e.jsx(v,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[e.jsx(V,{className:"h-4 w-4"}),"Statistik Permission"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-blue-50 dark:bg-blue-950 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:p()}),e.jsx("div",{className:"text-sm text-blue-700 dark:text-blue-300",children:"Dipilih"})]}),e.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-600",children:u()}),e.jsx("div",{className:"text-sm text-gray-700",children:"Total"})]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${p()/u()*100}%`}})}),e.jsxs("p",{className:"text-sm text-gray-600 text-center",children:[Math.round(p()/u()*100),"% permission dipilih"]})]}),e.jsx(v,{}),i&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h4",{className:"font-medium text-gray-900 flex items-center gap-2",children:[e.jsx(Y,{className:"h-4 w-4"}),"Hasil Pencarian"]}),e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-xl font-bold text-green-600",children:m.length}),e.jsx("div",{className:"text-sm text-green-700",children:"Module ditemukan"})]})]}),e.jsx(v,{}),e.jsx(j,{onClick:q,disabled:C,className:"w-full bg-blue-600 hover:bg-blue-700 h-12",size:"lg",children:C?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Menyimpan..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),"Simpan Perubahan"]})})]})]})}),e.jsx("div",{className:"xl:col-span-2",children:e.jsxs(d,{className:"shadow-lg border-0",children:[e.jsxs(N,{className:"bg-gradient-to-r from-green-600 to-green-700 text-white rounded-t-lg",children:[e.jsxs(D,{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-5 w-5"}),"Kelola Permission"]}),e.jsx(F,{className:"text-green-100",children:"Pilih permission yang diizinkan untuk role ini"})]}),e.jsxs(x,{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx(f,{htmlFor:"search",className:"text-sm font-medium text-gray-700 mb-2 block",children:"Cari Module atau Permission"}),e.jsxs("div",{className:"relative",children:[e.jsx(H,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(T,{id:"search",type:"text",placeholder:"Ketik nama module atau permission...",value:i,onChange:s=>S(s.target.value),className:"pl-10 pr-10"}),i&&e.jsx(j,{variant:"ghost",size:"sm",onClick:P,className:"absolute right-1 top-1/2 transform -translate-y-1/2 h-8 w-8 p-0 hover:bg-gray-100",children:e.jsx(I,{className:"h-4 w-4"})})]}),i&&e.jsxs("div",{className:"mt-2 flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-600",children:["Menampilkan ",m.length," dari ",h.length," module"]}),i&&e.jsxs(y,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:['Pencarian: "',i,'"']})]})]}),e.jsxs(E,{error:w.permissions,required:!0,children:[m.length===0&&i&&e.jsx(d,{className:"border-2 border-dashed border-gray-300",children:e.jsxs(x,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(H,{className:"h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Tidak ada hasil"}),e.jsxs("p",{className:"text-gray-500 text-center mb-4",children:['Tidak ditemukan module atau permission yang cocok dengan "',i,'"']}),e.jsxs(j,{variant:"outline",onClick:P,children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Hapus Pencarian"]})]})}),m.length>0&&e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:m.map(s=>{var r;return e.jsxs(d,{className:"border-2 hover:shadow-md transition-shadow",children:[e.jsx(N,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(L,{id:`module-${s.id}`,checked:o(s),onCheckedChange:a=>A(a,s),className:"data-[state=checked]:bg-green-600 data-[state=checked]:border-green-600"}),e.jsxs("div",{children:[e.jsx(f,{htmlFor:`module-${s.id}`,className:"text-base font-semibold text-gray-900 dark:text-gray-100 cursor-pointer",children:i?e.jsx("span",{dangerouslySetInnerHTML:{__html:s.name.replace(new RegExp(`(${i})`,"gi"),'<mark class="bg-yellow-200 px-1 rounded">$1</mark>')}}):s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(y,{variant:"outline",className:`text-xs ${o(s)?"bg-green-100 text-green-800 border-green-200":g(s)?"bg-yellow-100 text-yellow-800 border-yellow-200":"bg-gray-100 text-gray-600 border-gray-200"}`,children:o(s)?"Semua Dipilih":g(s)?"Sebagian Dipilih":"Tidak Dipilih"}),e.jsxs(y,{variant:"outline",className:"text-xs bg-blue-50 text-blue-700 border-blue-200",children:[s.actions.length," permission"]})]})]})]}),o(s)?e.jsx(_,{className:"h-5 w-5 text-green-600"}):g(s)?e.jsx(R,{className:"h-5 w-5 text-yellow-600 fill-current"}):e.jsx(R,{className:"h-5 w-5 text-gray-400"})]})}),e.jsx(x,{className:"pt-0",children:e.jsx("div",{className:"space-y-3",children:(r=s.actions)==null?void 0:r.map(a=>{var t,n;return e.jsxs("div",{className:"flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(L,{id:`${a.name}-${s.slug}`,checked:(t=l.permissions)==null?void 0:t.includes(`${a.name}-${s.slug}`),onCheckedChange:b=>G(b,a,s),className:"data-[state=checked]:bg-blue-600 data-[state=checked]:border-blue-600"}),e.jsx(f,{htmlFor:`${a.name}-${s.slug}`,className:"text-sm font-medium text-gray-700 dark:text-gray-300 cursor-pointer flex-1",children:i?e.jsx("span",{dangerouslySetInnerHTML:{__html:a.name.replace(new RegExp(`(${i})`,"gi"),'<mark class="bg-yellow-200 px-1 rounded">$1</mark>')}}):a.name}),((n=l.permissions)==null?void 0:n.includes(`${a.name}-${s.slug}`))&&e.jsx(_,{className:"h-4 w-4 text-blue-600"})]},`${a.name}-${s.slug}`)})})})]},s.id)})})]})]})]})})]})]})})}export{Re as default};
