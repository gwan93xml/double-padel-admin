import{r as l,j as e,a as p}from"./app-CQ-G37p-.js";import{B as k}from"./button-ymMXdPy5.js";import{I as f}from"./input-BXXA-PDa.js";import{S as K}from"./search-B9EA-nRY.js";import{X as q}from"./x-D2Pel9EU.js";import{F as m}from"./form-group-CHZXn8bM.js";import{M as j}from"./money-input-Bb590VQ4.js";import{T as F}from"./textarea-BvykTLwI.js";import"./index-D0iIn24t.js";import"./createLucideIcon-iWXofaGH.js";import"./label-Blk7FhF1.js";import"./index-DqZ46QiR.js";function R({onChange:d,value:r,clearable:i}){const[t,o]=l.useState({id:"0",code:"",name:""}),[s,u]=l.useState(!1),[g,c]=l.useState(""),b=l.useRef(!1),h=l.useRef(r);l.useEffect(()=>{r&&o({id:r.id||"0",code:r.code||"",name:r.name||""})},[]),l.useEffect(()=>{var a,n,C;r&&(((a=h.current)==null?void 0:a.id)!==r.id||((n=h.current)==null?void 0:n.code)!==r.code||((C=h.current)==null?void 0:C.name)!==r.name)&&(o({id:r.id||"0",code:r.code||"",name:r.name||""}),h.current=r)},[r]);const w=a=>{o({...t,code:a.target.value}),y(a.target.value),c("")},S=a=>{o({...t,name:a.target.value}),y(a.target.value),c("")},N=async a=>{if(a.trim()){u(!0),c("");try{const{data:n}=await p.get(`/admin/asset/search-by-code?search=${a}`);n.data?(b.current=!0,o({id:n.data.id,code:n.data.code,name:n.data.name}),d({id:n.data.id,code:n.data.code,name:n.data.name})):c("Item not found")}catch(n){c("Failed to search asset"),console.error(n)}finally{u(!1)}}},v=async a=>{if(a.trim()){u(!0),c("");try{const{data:n}=await p.get(`/admin/asset/search-by-name?search=${a}`);n.data?(b.current=!0,o({id:n.data.id,code:n.data.code,name:n.data.name}),d({id:n.data.id,code:n.data.code,name:n.data.name})):c("Item not found")}catch(n){c("Failed to search asset"),console.error(n)}finally{u(!1)}}},E=a=>{a.key==="Enter"&&N(t.code)},A=a=>{a.key==="Enter"&&v(t.name)},B=()=>{t.code?N(t.code):t.name&&v(t.name)},[_,x]=l.useState([]),y=a=>{if(a.length<2){x([]);return}p.get(`/admin/asset/browse?search=${a}`).then(n=>{x(n.data.data)}).catch(n=>{console.error("Error fetching asset:",n)})};function I(){o({id:"",code:"",name:""}),d({id:"",code:"",name:""}),x([]),c("")}return e.jsx("div",{className:"space-y-2 ",children:e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-1/4",children:e.jsx(f,{className:"rounded-r-none ",placeholder:"Kode Asset",value:t.code,onChange:w,onKeyDown:E,disabled:s})}),e.jsx("div",{children:e.jsx(k,{className:"rounded-none border ",onClick:B,disabled:s,children:e.jsx(K,{className:"h-4 w-4 "})})}),e.jsx("div",{className:"w-3/4",children:e.jsx(f,{className:"rounded-l-none ",placeholder:"Nama Asset",value:t.name,onChange:S,onKeyDown:A,disabled:s})}),i&&e.jsx(k,{onClick:I,children:e.jsx(q,{className:"h-4 w-4"})})]}),e.jsx("div",{className:`absolute bg-blue-300 w-full p-2  ${_.length>0?"block z-10 rounded shadow-sm":"hidden"}`,children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left",children:"Kode"}),e.jsx("th",{className:"text-left",children:"Nama"})]})}),e.jsx("tbody",{children:_.map(a=>e.jsxs("tr",{className:"cursor-pointer hover:bg-blue-200",onClick:()=>{o({id:a.id,code:a.code,name:a.name}),d({id:a.id,code:a.code,name:a.name}),x([])},children:[e.jsx("td",{children:a.code}),e.jsx("td",{children:a.name})]},a.id))})]})}),s&&e.jsx("div",{className:"text-sm text-muted-foreground",children:"Searching..."}),g&&e.jsx("div",{className:"text-sm text-destructive",children:g})]})})}function O({data:d,setData:r,errors:i}){var t,o;return e.jsxs("div",{className:"grid md:grid-cols-3 gap-x-4  gap-y-4",children:[e.jsx(m,{label:"Asset",error:i.asset_id,required:!0,children:e.jsx(R,{value:{id:d.asset_id,code:(t=d.asset)==null?void 0:t.code,name:(o=d.asset)==null?void 0:o.name},onChange:s=>{r({...d,asset_id:s.id,asset:s})}})}),e.jsx(m,{label:"Tanggal Penyusutan",error:i.depreciation_date,required:!0,children:e.jsx(f,{type:"date",value:d.depreciation_date,onChange:s=>{r("depreciation_date",s.target.value)}})}),e.jsx(m,{label:"Periode",error:i.depreciation_period,required:!0,children:e.jsx(f,{type:"month",value:d.depreciation_period,onChange:s=>{r("depreciation_period",s.target.value)}})}),e.jsx(m,{label:"Nilai Buku Awal",error:i.begin_book_value,required:!0,children:e.jsx(j,{value:d.begin_book_value,onValueChange:s=>{r("begin_book_value",s)}})}),e.jsx(m,{label:"Jumlah Penyusutan",error:i.depreciation_amount,required:!0,children:e.jsx(j,{value:d.depreciation_amount,onValueChange:s=>{r("depreciation_amount",s)}})}),e.jsx(m,{label:"Nilai Buku Akhir",error:i.ending_book_value,required:!0,children:e.jsx(j,{value:d.ending_book_value,onValueChange:s=>{r("ending_book_value",s)}})}),e.jsx("div",{className:"col-span-3",children:e.jsx(m,{label:"Catatan",error:i.notes,children:e.jsx(F,{value:d.notes,onChange:s=>{r("notes",s.target.value)},rows:3})})})]})}export{O as default};
