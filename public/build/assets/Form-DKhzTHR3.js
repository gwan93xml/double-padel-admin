import{W as ce,r as T,j as e,y as D}from"./app-xdIDsNuc.js";import{B as m}from"./index-D9fYs-5N.js";import{C as E}from"./checkbox-C3fx99cs.js";import{C as g,a as w,b as I,c as q,d as p}from"./card-DPe-xeUS.js";import{F as A}from"./form-group-DJppTG6k.js";import{I as B}from"./input-Pb5O0huv.js";import{L as C}from"./label-DxiqzSVl.js";import{S as me,a as u,C as $,B as S}from"./badge-ZAY5fO7e.js";import{t as V}from"./use-toast-BOfnQU58.js";import{c as x}from"./createLucideIcon-D9qBrcbq.js";import{C as M}from"./circle-check-big-DsX6mfvx.js";import{F as de,S as _}from"./search-DVUbBZlE.js";import{X as K}from"./x-Cp6Dz_ky.js";import"./utils-jM7Hu9J5.js";import"./index-CltWYr8P.js";import"./index-DY1xKekZ.js";import"./index-CCSo0cdO.js";import"./index-CZTB0vk4.js";import"./check-B2a_CU3u.js";/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=x("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=x("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=x("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=x("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=x("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);function Te({initialData:P={name:"",permissions:[]},modules:h,onSubmit:G,submitButtonText:Q,successMessage:Z,redirectTo:F,headerTitle:W,headerDescription:X,headerIcon:J,headerColor:j,showQuickActions:O=!1,showBackButton:U=!0}){var H;const{data:i,setData:c,clearErrors:Y,reset:ee,errors:L,setError:se}=ce({...P,permissions:((H=P.permissions)==null?void 0:H.map(s=>typeof s=="object"?s.name:s))||[]}),[N,z]=T.useState(!1),[l,b]=T.useState("");async function ae(){var s,r,a;Y(),z(!0);try{await G(i),V({title:"Sukses",description:Z}),D.visit(F)}catch(t){if(((s=t.response)==null?void 0:s.status)===422){const n=t.response.data.errors;se(n)}else V({variant:"destructive",title:"Gagal",description:((a=(r=t.response)==null?void 0:r.data)==null?void 0:a.message)||"Terjadi kesalahan"})}finally{z(!1)}}function re(s,r){const a=r.actions.map(t=>`${t.name}-${r.slug}`);if(s)c("permissions",[...i.permissions,...a]);else{const t=i.permissions.filter(n=>!a.includes(n));c("permissions",t)}}function te(s,r,a){const t=`${r.name}-${a.slug}`;if(s)c("permissions",[...i.permissions,t]);else{const n=i.permissions.filter(k=>k!==`${r.name}-${a.slug}`);c("permissions",n)}}const d=s=>s.actions.map(a=>`${a.name}-${s.slug}`).every(a=>{var t;return(t=i.permissions)==null?void 0:t.includes(a)}),y=s=>s.actions.map(a=>`${a.name}-${s.slug}`).some(a=>{var t;return(t=i.permissions)==null?void 0:t.includes(a)})&&!d(s),f=()=>{var s;return((s=i.permissions)==null?void 0:s.length)||0},v=()=>h.reduce((s,r)=>s+r.actions.length,0),o=h.filter(s=>{const r=s.name.toLowerCase().includes(l.toLowerCase()),a=s.actions.some(t=>t.name.toLowerCase().includes(l.toLowerCase()));return r||a}),R=()=>{b("")},le=()=>{const s=h.flatMap(r=>r.actions.map(a=>`${a.name}-${r.slug}`));c("permissions",s)},ie=()=>{c("permissions",[])},ne=()=>{ee(),b("")};return e.jsxs("div",{className:"p-4 md:p-6 bg-gradient-to-br from-blue-50 to-indigo-50 min-h-screen dark:from-gray-900 dark:to-gray-800",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:`p-2 ${j} rounded-lg`,children:J}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:W}),e.jsx("p",{className:"text-gray-600 dark:text-gray-200",children:X})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-6",children:[e.jsx("div",{className:"xl:col-span-1",children:e.jsxs(g,{className:"shadow-lg border-0 sticky top-6",children:[e.jsxs(w,{className:`${j} text-white rounded-t-lg`,children:[e.jsxs(I,{className:"flex items-center gap-2",children:[e.jsx(me,{className:"h-5 w-5"}),"Informasi Role"]}),e.jsx(q,{className:"text-blue-100",children:"Detail dan statistik role"})]}),e.jsxs(p,{className:"p-6 space-y-6",children:[e.jsx(A,{label:"Nama Role",error:L.name,required:!0,children:e.jsx(B,{type:"text",value:i.name,onChange:s=>c("name",s.target.value),placeholder:"Masukkan nama role",className:"mt-1"})}),e.jsx(u,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[e.jsx(ge,{className:"h-4 w-4"}),"Statistik Permission"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-blue-50 dark:bg-blue-950 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:f()}),e.jsx("div",{className:"text-sm text-blue-700 dark:text-blue-300",children:"Dipilih"})]}),e.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-600",children:v()}),e.jsx("div",{className:"text-sm text-gray-700",children:"Total"})]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${f()/v()*100}%`}})}),e.jsxs("p",{className:"text-sm text-gray-600 text-center",children:[Math.round(f()/v()*100),"% permission dipilih"]})]}),e.jsx(u,{}),O&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"font-medium text-gray-900 flex items-center gap-2",children:[e.jsx(pe,{className:"h-4 w-4"}),"Aksi Cepat"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(m,{variant:"outline",size:"sm",onClick:le,className:"text-xs bg-transparent",children:[e.jsx(M,{className:"h-3 w-3 mr-1"}),"Pilih Semua"]}),e.jsxs(m,{variant:"outline",size:"sm",onClick:ie,className:"text-xs bg-transparent",children:[e.jsx($,{className:"h-3 w-3 mr-1"}),"Hapus Semua"]})]}),e.jsxs(m,{variant:"outline",size:"sm",onClick:ne,className:"w-full text-xs bg-transparent",children:[e.jsx(xe,{className:"h-3 w-3 mr-1"}),"Reset Form"]})]}),e.jsx(u,{})]}),l&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h4",{className:"font-medium text-gray-900 flex items-center gap-2",children:[e.jsx(de,{className:"h-4 w-4"}),"Hasil Pencarian"]}),e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-xl font-bold text-blue-600",children:o.length}),e.jsx("div",{className:"text-sm text-blue-700",children:"Module ditemukan"})]})]}),e.jsx(u,{})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(m,{onClick:ae,disabled:N,className:`w-full ${j} h-12`,size:"lg",children:N?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Menyimpan..."]}):e.jsxs(e.Fragment,{children:[e.jsx(he,{className:"h-4 w-4 mr-2"}),Q]})}),U&&e.jsx(m,{variant:"outline",onClick:()=>D.visit(F),className:"w-full",disabled:N,children:"Kembali ke Daftar Role"})]})]})]})}),e.jsx("div",{className:"xl:col-span-2",children:e.jsxs(g,{className:"shadow-lg border-0",children:[e.jsxs(w,{className:"bg-gradient-to-r from-green-600 to-green-700 text-white rounded-t-lg",children:[e.jsxs(I,{className:"flex items-center gap-2",children:[e.jsx(oe,{className:"h-5 w-5"}),"Kelola Permission"]}),e.jsx(q,{className:"text-green-100",children:"Pilih permission yang diizinkan untuk role ini"})]}),e.jsxs(p,{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx(C,{htmlFor:"search",className:"text-sm font-medium text-gray-700 mb-2 block",children:"Cari Module atau Permission"}),e.jsxs("div",{className:"relative",children:[e.jsx(_,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(B,{id:"search",type:"text",placeholder:"Ketik nama module atau permission...",value:l,onChange:s=>b(s.target.value),className:"pl-10 pr-10"}),l&&e.jsx(m,{variant:"ghost",size:"sm",onClick:R,className:"absolute right-1 top-1/2 transform -translate-y-1/2 h-8 w-8 p-0 hover:bg-gray-100",children:e.jsx(K,{className:"h-4 w-4"})})]}),l&&e.jsxs("div",{className:"mt-2 flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-600",children:["Menampilkan ",o.length," dari ",h.length," module"]}),l&&e.jsxs(S,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:['Pencarian: "',l,'"']})]})]}),e.jsxs(A,{error:L.permissions,required:!0,children:[o.length===0&&l&&e.jsx(g,{className:"border-2 border-dashed border-gray-300",children:e.jsxs(p,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(_,{className:"h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Tidak ada hasil"}),e.jsxs("p",{className:"text-gray-500 text-center mb-4",children:['Tidak ditemukan module atau permission yang cocok dengan "',l,'"']}),e.jsxs(m,{variant:"outline",onClick:R,children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),"Hapus Pencarian"]})]})}),o.length>0&&e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:o.map(s=>{var r;return e.jsxs(g,{className:"border-2 hover:shadow-md transition-shadow",children:[e.jsx(w,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(E,{id:`module-${s.id}`,checked:d(s),onCheckedChange:a=>re(a,s),className:"data-[state=checked]:bg-green-600 data-[state=checked]:border-green-600"}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:`module-${s.id}`,className:"text-base font-semibold text-gray-900 dark:text-gray-100 cursor-pointer",children:l?e.jsx("span",{dangerouslySetInnerHTML:{__html:s.name.replace(new RegExp(`(${l})`,"gi"),'<mark class="bg-yellow-200 px-1 rounded">$1</mark>')}}):s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(S,{variant:"outline",className:`text-xs ${d(s)?"bg-green-100 text-green-800 border-green-200":y(s)?"bg-yellow-100 text-yellow-800 border-yellow-200":"bg-gray-100 text-gray-600 border-gray-200"}`,children:d(s)?"Semua Dipilih":y(s)?"Sebagian Dipilih":"Tidak Dipilih"}),e.jsxs(S,{variant:"outline",className:"text-xs bg-blue-50 text-blue-700 border-blue-200",children:[s.actions.length," permission"]})]})]})]}),d(s)?e.jsx(M,{className:"h-5 w-5 text-green-600"}):y(s)?e.jsx($,{className:"h-5 w-5 text-yellow-600 fill-current"}):e.jsx($,{className:"h-5 w-5 text-gray-400"})]})}),e.jsx(p,{className:"pt-0",children:e.jsx("div",{className:"space-y-3",children:(r=s.actions)==null?void 0:r.map(a=>{var t,n;return e.jsxs("div",{className:"flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(E,{id:`${a.name}-${s.slug}`,checked:(t=i.permissions)==null?void 0:t.includes(`${a.name}-${s.slug}`),onCheckedChange:k=>te(k,a,s),className:"data-[state=checked]:bg-blue-600 data-[state=checked]:border-blue-600"}),e.jsx(C,{htmlFor:`${a.name}-${s.slug}`,className:"text-sm font-medium text-gray-700 dark:text-gray-300 cursor-pointer flex-1",children:l?e.jsx("span",{dangerouslySetInnerHTML:{__html:a.name.replace(new RegExp(`(${l})`,"gi"),'<mark class="bg-yellow-200 px-1 rounded">$1</mark>')}}):a.name}),((n=i.permissions)==null?void 0:n.includes(`${a.name}-${s.slug}`))&&e.jsx(M,{className:"h-4 w-4 text-blue-600"})]},`${a.name}-${s.slug}`)})})})]},s.id)})})]})]})]})})]})]})}export{Te as default};
