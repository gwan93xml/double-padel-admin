import{r,a as z,j as e}from"./app-CQ-G37p-.js";import{C as E}from"./checkbox-DaA1krf_.js";import{B as x}from"./button-ymMXdPy5.js";import{C as P,a as g,b as A,c as T,d as S,e as B}from"./command-BCd-qebN.js";import{P as F,a as G,b as R}from"./popover-BMGWAYFn.js";import{C as V}from"./chevron-down-BOk5s691.js";import{C as j}from"./index-B9VoEdXn.js";import{X}from"./x-D2Pel9EU.js";function U({selectedDivisions:n=[],onSelectionChange:t,placeholder:v="Cari divisi...",className:w=""}){const[i,f]=r.useState([]),[N,p]=r.useState([]),[l,C]=r.useState(""),[b,u]=r.useState(!1),[d,o]=r.useState(new Set(n.map(s=>s.id).filter(s=>s!==void 0)));r.useEffect(()=>{L()},[]),r.useEffect(()=>{o(new Set(n.map(s=>s.id).filter(s=>s!==void 0)))},[n]),r.useEffect(()=>{if(!l.trim())p(i);else{const s=i.filter(a=>{var c,m;return((c=a.name)==null?void 0:c.toLowerCase().includes(l.toLowerCase()))||((m=a.code)==null?void 0:m.toLowerCase().includes(l.toLowerCase()))});p(s)}},[i,l]);const L=async()=>{u(!0);try{const{data:s}=await z.get("/admin/division/list",{params:{take:100}});f(s.data.map(a=>({id:a.id,name:a.name,code:a.code}))||[])}catch(s){console.error("Failed to load divisions:",s),f([])}finally{u(!1)}},h=s=>{if(!s.id)return;const a=new Set(d);a.has(s.id)?a.delete(s.id):a.add(s.id),o(a);const c=i.filter(m=>a.has(m.id));t==null||t(c)},k=()=>{const s=new Set(i.map(a=>a.id).filter(a=>a!==void 0));o(s),t==null||t(i)},y=()=>{o(new Set),t==null||t([])},D=i.length>0&&d.size===i.length,I=d.size===0;return e.jsx("div",{className:w,children:e.jsxs(F,{children:[e.jsx(G,{asChild:!0,children:e.jsxs(x,{variant:"outline",role:"combobox",className:"w-full justify-between",children:[d.size===0?"Pilih divisi...":`${d.size} divisi dipilih`,e.jsx(V,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(R,{className:"w-full p-0",align:"start",children:e.jsxs("div",{className:"p-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs(x,{type:"button",size:"sm",onClick:k,disabled:D,children:[e.jsx(j,{className:"h-4 w-4 mr-1"}),"All"]}),e.jsxs(x,{type:"button",variant:"outline",size:"sm",onClick:y,disabled:I,children:[e.jsx(X,{className:"h-4 w-4 mr-1"}),"Clear"]})]}),e.jsxs(P,{className:"rounded-lg",children:[e.jsx(g,{placeholder:v,value:l,onValueChange:C}),e.jsxs(A,{className:"max-h-64",children:[e.jsx(T,{children:b?"Loading divisions...":l?"No divisions found":"No divisions available"}),e.jsx(S,{children:N.map(s=>e.jsxs(B,{onSelect:()=>h(s),className:"flex items-center space-x-3 p-2 cursor-pointer",children:[e.jsx(E,{checked:d.has(s.id),onCheckedChange:()=>h(s),onClick:a=>a.stopPropagation()}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:s.name}),e.jsx("div",{className:"text-gray-500 text-xs",children:s.code})]}),d.has(s.id)&&e.jsx(j,{className:"h-4 w-4 text-green-600"})]},s.id))})]})]})]})})]})})}export{U as D};
