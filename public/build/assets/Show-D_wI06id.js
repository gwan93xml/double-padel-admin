import{r as s,W as y,j as r,a as g}from"./app-CQ-G37p-.js";import{h as u}from"./moment-C5S46NFB.js";import{A as E}from"./AuthenticatedLayout-X6euxa7E.js";import{I as d}from"./input-BXXA-PDa.js";import{F as i}from"./form-group-CHZXn8bM.js";import{S as N}from"./select-remote-C3ahzpc3.js";import{T as q}from"./textarea-BvykTLwI.js";import{S as Y}from"./SearchDivision-Budjprvk.js";import{S as F}from"./SearchCustomer-BbTZ5_2l.js";import{S as P}from"./SearchWarehouse-Bw-VGbhg.js";import{C as k}from"./CashCredit-BZxMHD02.js";import M from"./SaleItemForm-BzHc6leC.js";import L from"./SaleItemTotal-m3BHMHcm.js";import J from"./SaleItemList-BUU4L9yW.js";import"./index-D0iIn24t.js";import"./button-ymMXdPy5.js";import"./createLucideIcon-iWXofaGH.js";import"./index-DqZ46QiR.js";import"./index-BHS3gC_j.js";import"./index-B9C1SM0Q.js";import"./tslib.es6-eMSY344_.js";import"./index-uJ2KZHf0.js";import"./x-D2Pel9EU.js";import"./index-C7S3ohsj.js";import"./index-B9VoEdXn.js";import"./can-DARgw7Bo.js";import"./chevron-right-DWL5tPD-.js";import"./use-toast-XJEkqv7A.js";import"./badge-CsIJHFj0.js";import"./currency-formatter-D5vTOkIG.js";import"./triangle-alert-byTh5Szo.js";import"./calendar-BV_-Gsoc.js";import"./label-Blk7FhF1.js";import"./select-BSIJzAmS.js";import"./index-CZ_DqijM.js";import"./chevron-down-BOk5s691.js";import"./index-CwCPKFMf.js";import"./search-B9EA-nRY.js";import"./card-Bq41eL_q.js";import"./loader-circle-i2ANfqrZ.js";import"./SearchChartOfAccount-0Jd4yGJY.js";import"./file-text-vhY6aTSF.js";import"./SearchItem-DGpcvLrN.js";import"./package-Cd0mGsRo.js";import"./SearchItemNonStock-BQ2Ydllm.js";import"./SearchSubUnit-CTrUekdR.js";import"./dialog-CBBIkam9.js";import"./money-input-Bb590VQ4.js";import"./auto-manual-toggle-Drq7Gsew.js";import"./settings-BIxmfjj-.js";import"./lodash-Caeo88pO.js";import"./EmptyTable-CjEJGtgb.js";import"./table-BSdxGOLt.js";import"./pencil-XLeJOTln.js";import"./trash-C6VGYEst.js";function O({sale:m}){var c,h,x,f,j,v;s.useState(!1);const{data:e,setData:t,errors:o,setError:A,clearErrors:G}=y(m),{data:l,setData:b}=y({}),[S,p]=s.useState({}),[C,w]=s.useState();s.useEffect(()=>{async function a(){const T=await g.get(`/admin/type-of-tax/${e.type_of_tax_id}`);w(T.data.data)}a()},[e.type_of_tax_id]),s.useEffect(()=>{t({...e,due_date:u(e.sale_date).add(1,"month").format("YYYY-MM-DD"),due_date_days:u(e.sale_date).add(1,"month").diff(u(e.sale_date),"days")})},[e.sale_date]),s.useEffect(()=>{m.due_date_days&&t({...e,due_date:u(e.sale_date).add(m.due_date_days,"days").format("YYYY-MM-DD")})},[m.due_date_days]);const[n,_]=s.useState({open:!1,isEdit:!1,index:0}),D=async()=>{try{return await g.post("/admin/sale/validate",l),p({}),!0}catch(a){return p(a.response.data.errors),!1}},I=async()=>{if(await D()){if(n.isEdit){const a=e.items;a[n.index]=l,t({...e,items:a})}else t("items",[...e.items,l]);_({...n,open:!1})}};return r.jsxs("div",{className:"pt-5  px-5",children:[r.jsxs("div",{className:"grid grid-cols-3 gap-x-4  gap-y-4",children:[r.jsx(i,{label:"Pelanggan",error:o.customer_id,name:"customer_id",required:!0,children:r.jsx(F,{value:{id:e.customer_id??"",code:((c=e.customer)==null?void 0:c.code)??"",name:((h=e.customer)==null?void 0:h.name)??""},onChange:a=>{t({...e,customer_id:a.id,customer:a})}})}),r.jsx(i,{label:"Jenis Pajak",error:o.type_of_tax_id,name:"type_of_tax_id",required:!0,children:r.jsx(N,{value:e.type_of_tax_id,remoteConfig:{url:"/admin/type-of-tax/list",label:a=>a.name,value:a=>a.id.toString()},onValueChange:a=>{t({...e,type_of_tax_id:a})}})}),r.jsx(i,{label:"Gudang",error:o.warehouse_id,name:"warehouse_id",required:!0,children:r.jsx(P,{value:{id:e.warehouse_id??"",code:((x=e.warehouse)==null?void 0:x.code)??"",name:((f=e.warehouse)==null?void 0:f.name)??""},onChange:a=>{t({...e,warehouse_id:a.id,warehouse:a})}})}),r.jsx(i,{label:"Divisi",error:o.division_id,name:"division_id",required:!0,children:r.jsx(Y,{value:{id:e.division_id??"",code:((j=e.division)==null?void 0:j.code)??"",name:((v=e.division)==null?void 0:v.name)??""},onChange:a=>{t({...e,division_id:a.id,division:a})},clearable:!0})}),r.jsx(i,{label:"Tanggal",error:o.sale_date,name:"sale_date",required:!0,children:r.jsx(d,{type:"date",value:e.sale_date,onChange:a=>{t({...e,sale_date:a.target.value})}})}),r.jsx(i,{label:"No",error:o.no,name:"no",required:!0,children:r.jsx(d,{type:"text",value:e.no,onChange:a=>{t({...e,no:a.target.value})}})}),r.jsx(i,{label:"No. SO",error:o.sales_order_number,name:"sales_order_number",children:r.jsx(d,{type:"text",value:e.sales_order_number,onChange:a=>{t({...e,sales_order_number:a.target.value})}})}),r.jsx(i,{label:"No. PO",error:o.purchase_order_number,name:"purchase_order_number",children:r.jsx(d,{type:"text",value:e.purchase_order_number,onChange:a=>{t({...e,purchase_order_number:a.target.value})}})}),r.jsx(i,{label:"Metode Pembayaran",error:o.payment_method,name:"payment_method",required:!0,children:r.jsx(k,{value:e.payment_method??"Credit",onChange:a=>{t({...e,payment_method:a})}})}),r.jsx(i,{label:"Faktur Pajak",error:o.tax_invoice_number,name:"tax_invoice_number",required:!0,children:r.jsx(d,{type:"text",value:e.tax_invoice_number,onChange:a=>{t({...e,tax_invoice_number:a.target.value})}})}),e.payment_method=="Credit"&&r.jsxs(r.Fragment,{children:[r.jsx(i,{label:"Lama Jatuh Tempo (Hari)",error:o.due_date,name:"due_date_days",children:r.jsx(d,{type:"number",className:"text-right",value:e.due_date_days,onChange:a=>{t({...e,due_date_days:Number.parseInt(a.target.value)})}})}),r.jsx(i,{label:"Jatuh Tempo",error:o.due_date,name:"due_date",children:r.jsx(d,{type:"date",value:e.due_date,onChange:a=>{t({...e,due_date:a.target.value})}})})]}),r.jsx("div",{className:"col-span-3",children:r.jsx(i,{label:"Catatan",error:o.note,name:"note",children:r.jsx(q,{value:e.note,onChange:a=>{t({...e,note:a.target.value})}})})}),r.jsx("div",{className:"col-span-3",children:r.jsx(J,{items:e.items??[]})}),r.jsx("div",{className:"col-span-3",children:r.jsx(L,{data:e,setData:t,type_ofTax:C})})]}),r.jsx(M,{formDialog:n,data:l,setData:b,onOpenChange:()=>{_({...n,open:!1})},errors:S,warehouse_id:e.warehouse_id,onSave:I})]})}O.layout=m=>r.jsx(E,{breadcrumbs:[{label:"Dashboard",href:"/admin/"},{label:"Transaksi",href:"#"},{label:"Penjualan",href:"/admin/sale"},{label:"Lihat",href:"#"}],children:m});export{O as default};
