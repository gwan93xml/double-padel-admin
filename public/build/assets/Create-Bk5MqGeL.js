import{W as X,r as F,j as e,y as L,a as J}from"./app-CQ-G37p-.js";import{B as c}from"./button-ymMXdPy5.js";import{C as R}from"./checkbox-DaA1krf_.js";import{C as h,a as v,b as D,c as T,d as p}from"./card-Bq41eL_q.js";import{F as z}from"./form-group-CHZXn8bM.js";import{I as A}from"./input-BXXA-PDa.js";import{L as w}from"./label-Blk7FhF1.js";import{B as k}from"./badge-CsIJHFj0.js";import{A as O,a as g,b as C}from"./AuthenticatedLayout-X6euxa7E.js";import{t as B}from"./use-toast-XJEkqv7A.js";import{P as V}from"./plus-gEoqNGty.js";import{U as Y}from"./users-CyDfFij0.js";import{S as ee}from"./settings-BIxmfjj-.js";import{a as se}from"./createLucideIcon-iWXofaGH.js";import{C as $}from"./circle-check-big-DDOzmUMH.js";import{R as ae}from"./rotate-ccw-CoUcsd2p.js";import{F as re}from"./filter-BZN7rDIQ.js";import{S as te}from"./save-CHEDKyco.js";import{L as ie}from"./lock-hNhsjlZw.js";import{S as E}from"./search-B9EA-nRY.js";import{X as H}from"./x-D2Pel9EU.js";import"./index-D0iIn24t.js";import"./index-B9C1SM0Q.js";import"./index-DqZ46QiR.js";import"./tslib.es6-eMSY344_.js";import"./index-CZ_DqijM.js";import"./index-B9VoEdXn.js";import"./index-uJ2KZHf0.js";import"./index-BHS3gC_j.js";import"./index-C7S3ohsj.js";import"./can-DARgw7Bo.js";import"./chevron-right-DWL5tPD-.js";import"./currency-formatter-D5vTOkIG.js";import"./moment-C5S46NFB.js";import"./triangle-alert-byTh5Szo.js";import"./calendar-BV_-Gsoc.js";/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=se("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);function Ke({modules:x}){const{data:l,setData:n,clearErrors:I,reset:_,errors:P,setError:q}=X({name:"",permissions:[]}),[u,S]=F.useState(!1),[i,j]=F.useState("");async function K(){I(),S(!0);try{const s=await J.post("/admin/role",l);B({title:"Sukses",description:"Data role berhasil ditambah"}),L.visit("/admin/role")}catch(s){if(s.response.status===422){const r=s.response.data.errors;q(r)}else B({variant:"destructive",title:"Gagal",description:s.response.data.message})}finally{S(!1)}}function G(s,r){const a=r.actions.map(t=>`${t.name}-${r.slug}`);if(s)n("permissions",[...l.permissions,...a]);else{const t=l.permissions.filter(o=>!a.includes(o));n("permissions",t)}}function Q(s,r,a){const t=`${r.name}-${a.slug}`;if(s)n("permissions",[...l.permissions,t]);else{const o=l.permissions.filter(y=>y!==`${r.name}-${a.slug}`);n("permissions",o)}}const m=s=>s.actions.map(a=>`${a.name}-${s.slug}`).every(a=>{var t;return(t=l.permissions)==null?void 0:t.includes(a)}),b=s=>s.actions.map(a=>`${a.name}-${s.slug}`).some(a=>{var t;return(t=l.permissions)==null?void 0:t.includes(a)})&&!m(s),N=()=>{var s;return((s=l.permissions)==null?void 0:s.length)||0},f=()=>x.reduce((s,r)=>s+r.actions.length,0),d=x.filter(s=>{const r=s.name.toLowerCase().includes(i.toLowerCase()),a=s.actions.some(t=>t.name.toLowerCase().includes(i.toLowerCase()));return r||a}),M=()=>{j("")},U=()=>{const s=x.flatMap(r=>r.actions.map(a=>`${a.name}-${r.slug}`));n("permissions",s)},Z=()=>{n("permissions",[])},W=()=>{_(),j("")};return e.jsx(O,{breadcrumbs:[{label:"Dashboard",href:"/admin"},{label:"Pengaturan",href:"#"},{label:"Role",href:"/admin/role"},{label:"Tambah",href:"#"}],children:e.jsxs("div",{className:"p-4 md:p-6 bg-gradient-to-br from-blue-50 to-indigo-50 min-h-screen dark:from-gray-900 dark:to-gray-800",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 bg-green-600 rounded-lg",children:e.jsx(V,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Tambah Role Baru"}),e.jsx("p",{className:"text-gray-600",children:"Buat role baru dengan hak akses dan permission yang sesuai"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-6",children:[e.jsx("div",{className:"xl:col-span-1",children:e.jsxs(h,{className:"shadow-lg border-0 sticky top-6",children:[e.jsxs(v,{className:"bg-gradient-to-r from-green-600 to-green-700 text-white rounded-t-lg",children:[e.jsxs(D,{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-5 w-5"}),"Informasi Role"]}),e.jsx(T,{className:"text-green-100",children:"Detail dan statistik role baru"})]}),e.jsxs(p,{className:"p-6 space-y-6",children:[e.jsx(z,{label:"Nama Role",error:P.name,required:!0,children:e.jsx(A,{type:"text",value:l.name,onChange:s=>n("name",s.target.value),placeholder:"Masukkan nama role",className:"mt-1"})}),e.jsx(g,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4"}),"Statistik Permission"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:N()}),e.jsx("div",{className:"text-sm text-green-700",children:"Dipilih"})]}),e.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-600",children:f()}),e.jsx("div",{className:"text-sm text-gray-700",children:"Total"})]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-300",style:{width:`${N()/f()*100}%`}})}),e.jsxs("p",{className:"text-sm text-gray-600 text-center",children:[Math.round(N()/f()*100),"% permission dipilih"]})]}),e.jsx(g,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"font-medium text-gray-900 flex items-center gap-2",children:[e.jsx(le,{className:"h-4 w-4"}),"Aksi Cepat"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(c,{variant:"outline",size:"sm",onClick:U,className:"text-xs bg-transparent",children:[e.jsx($,{className:"h-3 w-3 mr-1"}),"Pilih Semua"]}),e.jsxs(c,{variant:"outline",size:"sm",onClick:Z,className:"text-xs bg-transparent",children:[e.jsx(C,{className:"h-3 w-3 mr-1"}),"Hapus Semua"]})]}),e.jsxs(c,{variant:"outline",size:"sm",onClick:W,className:"w-full text-xs bg-transparent",children:[e.jsx(ae,{className:"h-3 w-3 mr-1"}),"Reset Form"]})]}),e.jsx(g,{}),i&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h4",{className:"font-medium text-gray-900 flex items-center gap-2",children:[e.jsx(re,{className:"h-4 w-4"}),"Hasil Pencarian"]}),e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-xl font-bold text-blue-600",children:d.length}),e.jsx("div",{className:"text-sm text-blue-700",children:"Module ditemukan"})]})]}),e.jsx(g,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(c,{onClick:K,disabled:u,className:"w-full bg-green-600 hover:bg-green-700 h-12",size:"lg",children:u?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Menyimpan..."]}):e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Simpan Role"]})}),e.jsx(c,{variant:"outline",onClick:()=>L.visit("/admin/role"),className:"w-full",disabled:u,children:"Kembali ke Daftar Role"})]})]})]})}),e.jsx("div",{className:"xl:col-span-2",children:e.jsxs(h,{className:"shadow-lg border-0",children:[e.jsxs(v,{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-t-lg",children:[e.jsxs(D,{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"h-5 w-5"}),"Kelola Permission"]}),e.jsx(T,{className:"text-blue-100",children:"Pilih permission yang diizinkan untuk role baru ini"})]}),e.jsxs(p,{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx(w,{htmlFor:"search",className:"text-sm font-medium text-gray-700 mb-2 block",children:"Cari Module atau Permission"}),e.jsxs("div",{className:"relative",children:[e.jsx(E,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(A,{id:"search",type:"text",placeholder:"Ketik nama module atau permission...",value:i,onChange:s=>j(s.target.value),className:"pl-10 pr-10"}),i&&e.jsx(c,{variant:"ghost",size:"sm",onClick:M,className:"absolute right-1 top-1/2 transform -translate-y-1/2 h-8 w-8 p-0 hover:bg-gray-100",children:e.jsx(H,{className:"h-4 w-4"})})]}),i&&e.jsxs("div",{className:"mt-2 flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-600",children:["Menampilkan ",d.length," dari ",x.length," module"]}),i&&e.jsxs(k,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:['Pencarian: "',i,'"']})]})]}),e.jsxs(z,{error:P.permissions,required:!0,children:[d.length===0&&i&&e.jsx(h,{className:"border-2 border-dashed border-gray-300",children:e.jsxs(p,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(E,{className:"h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Tidak ada hasil"}),e.jsxs("p",{className:"text-gray-500 text-center mb-4",children:['Tidak ditemukan module atau permission yang cocok dengan "',i,'"']}),e.jsxs(c,{variant:"outline",onClick:M,children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),"Hapus Pencarian"]})]})}),d.length>0&&e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:d.map(s=>{var r;return e.jsxs(h,{className:"border-2 hover:shadow-md transition-shadow",children:[e.jsx(v,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(R,{id:`module-${s.id}`,checked:m(s),onCheckedChange:a=>G(a,s),className:"data-[state=checked]:bg-blue-600 data-[state=checked]:border-blue-600"}),e.jsxs("div",{children:[e.jsx(w,{htmlFor:`module-${s.id}`,className:"text-base font-semibold text-gray-900 cursor-pointer",children:i?e.jsx("span",{dangerouslySetInnerHTML:{__html:s.name.replace(new RegExp(`(${i})`,"gi"),'<mark class="bg-yellow-200 px-1 rounded">$1</mark>')}}):s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(k,{variant:"outline",className:`text-xs ${m(s)?"bg-green-100 text-green-800 border-green-200":b(s)?"bg-yellow-100 text-yellow-800 border-yellow-200":"bg-gray-100 text-gray-600 border-gray-200"}`,children:m(s)?"Semua Dipilih":b(s)?"Sebagian Dipilih":"Tidak Dipilih"}),e.jsxs(k,{variant:"outline",className:"text-xs bg-blue-50 text-blue-700 border-blue-200",children:[s.actions.length," permission"]})]})]})]}),m(s)?e.jsx($,{className:"h-5 w-5 text-green-600"}):b(s)?e.jsx(C,{className:"h-5 w-5 text-yellow-600 fill-current"}):e.jsx(C,{className:"h-5 w-5 text-gray-400"})]})}),e.jsx(p,{className:"pt-0",children:e.jsx("div",{className:"space-y-3",children:(r=s.actions)==null?void 0:r.map(a=>{var t,o;return e.jsxs("div",{className:"flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(R,{id:`${a.name}-${s.slug}`,checked:(t=l.permissions)==null?void 0:t.includes(`${a.name}-${s.slug}`),onCheckedChange:y=>Q(y,a,s),className:"data-[state=checked]:bg-blue-600 data-[state=checked]:border-blue-600"}),e.jsx(w,{htmlFor:`${a.name}-${s.slug}`,className:"text-sm font-medium text-gray-700 cursor-pointer flex-1",children:i?e.jsx("span",{dangerouslySetInnerHTML:{__html:a.name.replace(new RegExp(`(${i})`,"gi"),'<mark class="bg-yellow-200 px-1 rounded">$1</mark>')}}):a.name}),((o=l.permissions)==null?void 0:o.includes(`${a.name}-${s.slug}`))&&e.jsx($,{className:"h-4 w-4 text-blue-600"})]},`${a.name}-${s.slug}`)})})})]},s.id)})})]})]})]})})]})]})})}export{Ke as default};
