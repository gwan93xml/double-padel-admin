import{r,a as W,j as e}from"./app-CQ-G37p-.js";import{A as q}from"./AuthenticatedLayout-X6euxa7E.js";import{C as d,a as Y,b as P,c as $,d as l}from"./card-Bq41eL_q.js";import{h as m}from"./moment-C5S46NFB.js";import{S as z}from"./SearchItem-DGpcvLrN.js";import{S as V}from"./SearchWarehouse-Bw-VGbhg.js";import{B as k}from"./button-ymMXdPy5.js";import{T as J,a as Q,b as F,c as i,d as X,e as n}from"./table-BSdxGOLt.js";import{F as u}from"./form-group-CHZXn8bM.js";import{I as A}from"./input-BXXA-PDa.js";import{L as f}from"./label-Blk7FhF1.js";import{B as x}from"./badge-CsIJHFj0.js";import{c as y}from"./can-DARgw7Bo.js";import Z from"./EditModal-oEkIzOiu.js";import{P as h}from"./package-Cd0mGsRo.js";import{F as ee}from"./filter-BZN7rDIQ.js";import{T as N,a as v}from"./trending-up-BOlMp1Uy.js";import{C as I}from"./calendar-BV_-Gsoc.js";import{W as _}from"./warehouse-DEv1PKrL.js";import{S as ae}from"./search-B9EA-nRY.js";import{F as se}from"./file-text-vhY6aTSF.js";import{F as te}from"./file-spreadsheet-Dv5Qp-1R.js";import{L as re}from"./list-DIayZXqH.js";import{E}from"./external-link-BJRrkVwF.js";import{P as de}from"./pencil-XLeJOTln.js";import"./index-D0iIn24t.js";import"./createLucideIcon-iWXofaGH.js";import"./index-DqZ46QiR.js";import"./index-BHS3gC_j.js";import"./index-B9C1SM0Q.js";import"./tslib.es6-eMSY344_.js";import"./index-uJ2KZHf0.js";import"./x-D2Pel9EU.js";import"./index-C7S3ohsj.js";import"./index-B9VoEdXn.js";import"./chevron-right-DWL5tPD-.js";import"./use-toast-XJEkqv7A.js";import"./currency-formatter-D5vTOkIG.js";import"./triangle-alert-byTh5Szo.js";import"./loader-circle-i2ANfqrZ.js";import"./dialog-CBBIkam9.js";import"./ProcessingButton-Da7kiAJ4.js";import"./promise-alert-dialog-DMOGPPD8.js";import"./textarea-BvykTLwI.js";function le(){const[s,g]=r.useState({from_date:m().startOf("month").format("YYYY-MM-DD"),to_date:m().endOf("month").format("YYYY-MM-DD"),item_id:"",warehouse_id:"",warehouse:{code:"",name:"",id:""}}),[c,w]=r.useState([]),[j,L]=r.useState({starting_balance:"0",total_in:"0",total_out:"0",closing_balance:"0"}),[p,S]=r.useState(!1),[b,K]=r.useState(!1),T=r.useCallback(async()=>{if(s.item_id){S(!0);try{const{data:a}=await W.get("/admin/stock-card/list",{params:{from_date:s.from_date,to_date:s.to_date,item_id:s.item_id,warehouse_id:s.warehouse_id}});w(a.data.transactions||[]),L({starting_balance:a.data.starting_balance||"0",total_in:a.data.total_in||"0",total_out:a.data.total_out||"0",closing_balance:a.data.closing_balance||"0"}),K(!0)}catch(a){console.error("Error loading data:",a),w([])}finally{S(!1)}}},[s]),B=()=>{T()};function G(a){const o={"App\\Models\\Sale":`/admin/sale/${a.reference_id}/edit`,"App\\Models\\Purchase":`/admin/purchase/${a.reference_id}/edit`,"App\\Models\\StockMovement":`/admin/stock-movement/${a.reference_id}/edit`,"App\\Models\\ItemIn":`/admin/item-in/${a.reference_id}/edit`,"App\\Models\\ItemOut":`/admin/item-out/${a.reference_id}/edit`,"App\\Models\\Production":`/admin/production/${a.reference_id}/edit`}[a.reference_type];o&&window.open(o,"_blank")}function H(a){var t;window.open(`/admin/item/${(t=a.linking_item)==null?void 0:t.id}/edit`,"_blank")}const C=a=>{const t=new URLSearchParams;return a.from_date&&t.append("from_date",a.from_date),a.to_date&&t.append("to_date",a.to_date),a.item_id&&t.append("item_id",a.item_id),a.warehouse_id&&t.append("warehouse_id",a.warehouse_id),t.toString()},[O,R]=r.useState(null),[M,D]=r.useState(!1),U=a=>{R(a),D(!0)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"h-screen overflow-y-auto p-4 md:p-6 bg-gradient-to-br ",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2  rounded-lg",children:e.jsx(h,{className:"h-6 w-6 "})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold ",children:"Kartu Stok"}),e.jsx("p",{className:"",children:"Detail pergerakan stok item per transaksi"})]})]})}),e.jsxs(d,{className:"mb-6 ",children:[e.jsxs(Y,{className:"bg-gradient-to-r rounded-t-lg border-b",children:[e.jsxs(P,{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-5 w-5"}),"Filter Pencarian"]}),e.jsx($,{className:"",children:"Tentukan kriteria untuk melihat kartu stok"})]}),e.jsxs(l,{className:"p-6",children:[b&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx(d,{className:"bg-gradient-to-r ",children:e.jsx(l,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:" text-sm",children:"Saldo Awal"}),e.jsx("p",{className:"text-2xl font-bold",children:j.starting_balance})]}),e.jsx(N,{className:"h-8 w-8 "})]})})}),e.jsx(d,{className:"bg-gradient-to-r from-green-500 to-green-600 text-white",children:e.jsx(l,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-green-100 text-sm",children:"Total Masuk"}),e.jsx("p",{className:"text-2xl font-bold",children:j.total_in})]}),e.jsx(N,{className:"h-8 w-8 text-green-200"})]})})}),e.jsx(d,{className:"bg-gradient-to-r from-red-500 to-red-600 text-white",children:e.jsx(l,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-red-100 text-sm",children:"Total Keluar"}),e.jsx("p",{className:"text-2xl font-bold",children:j.total_out})]}),e.jsx(v,{className:"h-8 w-8 text-red-200"})]})})}),e.jsx(d,{className:"bg-gradient-to-r from-purple-500 to-purple-600 text-white",children:e.jsx(l,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-purple-100 text-sm",children:"Saldo Akhir"}),e.jsx("p",{className:"text-2xl font-bold",children:j.closing_balance})]}),e.jsx(h,{className:"h-8 w-8 text-purple-200"})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium ",children:[e.jsx(I,{className:"h-4 w-4"}),"Periode Transaksi"]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsxs(u,{children:[e.jsx(f,{htmlFor:"from_date",className:"text-sm font-medium",children:"Dari Tanggal"}),e.jsx(A,{id:"from_date",type:"date",value:s.from_date,onChange:a=>g(t=>({...t,from_date:a.target.value})),className:"mt-1"})]}),e.jsxs(u,{children:[e.jsx(f,{htmlFor:"to_date",className:"text-sm font-medium",children:"Sampai Tanggal"}),e.jsx(A,{id:"to_date",type:"date",value:s.to_date,onChange:a=>g(t=>({...t,to_date:a.target.value})),className:"mt-1"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:[e.jsx(h,{className:"h-4 w-4"}),"Filter Item"]}),e.jsxs(u,{children:[e.jsx(f,{className:"text-sm font-medium",children:"Pilih Item"}),e.jsx(z,{value:{code:"",name:"",id:"",purchase_price:"",selling_price:"",unit:""},onChange:a=>g(t=>({...t,item_id:a.id}))})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:[e.jsx(_,{className:"h-4 w-4"}),"Filter Gudang"]}),e.jsxs(u,{children:[e.jsx(f,{className:"text-sm font-medium",children:"Pilih Gudang (Opsional)"}),e.jsx(V,{value:{code:s.warehouse.code,name:s.warehouse.name,id:s.warehouse.id},onChange:a=>{g(t=>({...t,warehouse_id:`${a.id??""}`,warehouse:{code:`${a.code??""}`,name:`${a.name??""}`,id:`${a.id??""}`}}))},clearable:!0})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t",children:e.jsx(k,{onClick:B,className:" px-8",disabled:p||!s.item_id,children:p?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white dark:border-black mr-2"}),"Memproses..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Tampilkan Kartu Stok"]})})})]})]}),c.length>0&&e.jsxs("div",{className:"mb-4 flex justify-end gap-2",children:[e.jsx(k,{variant:"outline",size:"sm",asChild:!0,className:"bg-red-50 hover:bg-red-100 text-red-700 border-red-200",children:e.jsxs("a",{href:`/admin/stock-card/pdf?${C(s)}`,target:"_blank",rel:"noreferrer",children:[e.jsx(se,{className:"h-4 w-4 mr-1"})," PDF"]})}),e.jsx(k,{variant:"outline",size:"sm",asChild:!0,className:"bg-green-50 hover:bg-green-100 text-green-700 border-green-200",children:e.jsxs("a",{href:`/admin/stock-card/excel?${C(s)}`,target:"_blank",rel:"noreferrer",children:[e.jsx(te,{className:"h-4 w-4 mr-1"})," Excel"]})})]}),c.length>0&&e.jsxs(d,{className:"",children:[e.jsxs(Y,{className:"",children:[e.jsxs(P,{className:"text-xl text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[e.jsx(re,{className:"h-5 w-5"})," Detail Kartu Stok"]}),e.jsxs($,{children:["Menampilkan ",c.length," transaksi untuk periode ",m(s.from_date).format("DD/MM/YYYY")," -"," ",m(s.to_date).format("DD/MM/YYYY")]})]}),e.jsx(l,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(J,{children:[e.jsx(Q,{children:e.jsxs(F,{className:"",children:[e.jsx(i,{className:"font-semibold text-gray-900 dark:text-gray-100 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-4 w-4"}),"Tanggal"]})}),e.jsx(i,{className:"font-semibold text-gray-900 dark:text-gray-100",children:"Keterangan"}),e.jsx(i,{className:"font-semibold text-gray-900 dark:text-gray-100",children:"Customer/Vendor"}),e.jsx(i,{className:"text-center font-semibold text-gray-900 dark:text-gray-100  w-[150px]",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(N,{className:"h-4 w-4 text-green-600"}),"Debet"]})}),e.jsx(i,{className:"text-center font-semibold text-gray-900 dark:text-gray-100 w-[150px]",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(v,{className:"h-4 w-4 text-red-600 dark:text-red-400"}),"Kredit"]})}),e.jsx(i,{className:"text-right font-semibold text-gray-900 dark:text-gray-100  w-[150px]",children:"Saldo"}),e.jsx(i,{className:"font-semibold text-gray-900 dark:text-gray-100 w-[150px]",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{className:"h-4 w-4"}),"Gudang"]})}),y("update-stock-card")&&e.jsx(i,{className:"font-semibold text-gray-900 dark:text-gray-100"})]})}),e.jsx(X,{children:c.map((a,t)=>{var o;return e.jsxs(F,{className:"hover:bg-blue-50/50 dark:hover:bg-blue-950/50 transition-colors",children:[e.jsx(n,{className:"py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[a.type==="in"?e.jsx(N,{className:"h-4 w-4 text-green-600"}):e.jsx(v,{className:"h-4 w-4 text-red-600"}),e.jsx("span",{className:"font-medium",children:m(a.date).format("DD/MM/YYYY")})]})}),e.jsxs(n,{children:[e.jsxs(x,{variant:"secondary",onClick:()=>G(a),className:"cursor-pointer",children:[e.jsx("span",{className:"underline",children:a.notes}),e.jsx(E,{className:"h-3 w-3"})]}),a.linking_item&&e.jsxs(x,{onClick:()=>H(a),className:"cursor-pointer mt-1",children:[e.jsx("span",{className:"underline",children:(o=a.linking_item)==null?void 0:o.name})," Â ",e.jsx(E,{className:"h-3 w-3"})]})]}),e.jsx(n,{children:a.customer?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 bg-green-100 dark:bg-green-900 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xs font-medium text-green-600 dark:text-green-400",children:"C"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:a.customer.name}),e.jsx("div",{className:"text-xs text-gray-500",children:a.customer.code})]})]}):a.vendor?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xs font-medium text-blue-600 dark:text-blue-400",children:"V"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:a.vendor.name}),e.jsx("div",{className:"text-xs text-gray-500",children:a.vendor.code})]})]}):e.jsx("span",{className:"text-gray-400 dark:text-gray-600",children:"-"})}),e.jsx(n,{className:"text-end",children:a.type==="in"?e.jsxs(x,{className:"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-100 border-green-200 dark:border-green-800",variant:"outline",children:["+",a.quantity]}):e.jsx("span",{className:"text-gray-400 dark:text-gray-600",children:"-"})}),e.jsx(n,{className:"text-end",children:a.type==="out"?e.jsxs(x,{className:"bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200 border-red-200 dark:border-red-200",variant:"outline",children:["-",a.quantity]}):e.jsx("span",{className:"text-gray-400 dark:text-gray-600",children:"-"})}),e.jsx(n,{className:"text-right",children:e.jsx(x,{variant:"outline",className:`font-bold ${parseFloat(a.balance)>0?"bg-blue-50 dark:bg-blue-950 text-blue-700 dark:text-blue-300 border-blue-200 dark:border-blue-800":parseFloat(a.balance)<0?"bg-red-50 dark:bg-red-950 text-red-700 dark:text-red-300 border-red-200 dark:border-red-800":"bg-gray-50 dark:bg-gray-950 text-gray-700 dark:text-gray-300 border-gray-200 dark:border-gray-800"}`,children:a.balance})}),e.jsx(n,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 dark:bg-blue-900 rounded-lg flex items-center justify-center",children:e.jsx(_,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:a.warehouse.name}),e.jsx("div",{className:"text-xs text-gray-500",children:a.warehouse.code})]})]})}),(y("update-stock-card")||y("delete-stock-card"))&&e.jsx(n,{children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{className:"w-8 h-8 bg-blue-100 dark:bg-orange-900 rounded-lg flex items-center justify-center",onClick:()=>U(a),children:e.jsx(de,{className:"h-4 w-4 text-orange-600 dark:text-orange-400"})})})})]},a.id)})})]})})})]}),b&&c.length===0&&!p&&e.jsx(d,{className:"text-center py-12",children:e.jsx(l,{children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 dark:bg-gray-900 rounded-full flex items-center justify-center",children:e.jsx(h,{className:"h-8 w-8 text-gray-400 dark:text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Tidak Ada Data"}),e.jsx("p",{className:"text-gray-500",children:"Tidak ada transaksi untuk periode yang dipilih"})]})]})})}),!b&&!p&&e.jsx(d,{className:"text-center py-12",children:e.jsx(l,{children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 dark:bg-gray-900 rounded-full flex items-center justify-center",children:e.jsx(h,{className:"h-8 w-8 text-gray-400 dark:text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Belum Ada Data"}),e.jsx("p",{className:"text-gray-500",children:'Pilih item dan klik "Tampilkan Kartu Stok" untuk melihat pergerakan stok'})]})]})})})]}),e.jsx(Z,{open:M,onClose:()=>{D(!M),T()},itemTransaction:O})]})}le.layout=s=>e.jsx(q,{breadcrumbs:[{label:"Dashboard",href:"/admin"},{label:"Laporan",href:"#"},{label:"Kartu Stok",href:"#"}],children:s});export{le as default};
