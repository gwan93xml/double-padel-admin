import{r as t,j as a,a as B}from"./app-xdIDsNuc.js";import{c as R}from"./utils-jM7Hu9J5.js";import{B as H}from"./index-D9fYs-5N.js";import{s as j,P as O,a as A,f as l,b as I,C as _,c as E,d as K,e as $}from"./popover-BcYesNQU.js";import{C as c,a as m,b as d,c as h,d as z}from"./card-DPe-xeUS.js";import{S as G,a as J,b as V,c as X,d as q}from"./select-CnbTIwKL.js";import{a as L,h as p}from"./moment-DPfounic.js";import{R as Q,B as U,C as W,X as Z,Y as aa,a as ea}from"./BarChart-YJFtQliD.js";import"./chevron-left-BAjotGkp.js";import"./createLucideIcon-D9qBrcbq.js";import"./index-CltWYr8P.js";import"./index-Dy_V4ZJ5.js";import"./index-4rFdga_w.js";import"./index-CCSo0cdO.js";import"./index-CZTB0vk4.js";import"./index-DY1xKekZ.js";import"./check-B2a_CU3u.js";const sa=[{value:"7d",label:"7 Hari Terakhir"},{value:"30d",label:"30 Hari Terakhir"},{value:"90d",label:"90 Hari Terakhir"},{value:"6m",label:"6 Bulan Terakhir"},{value:"custom",label:"Kustom"}];function Ca(){const[i,g]=t.useState("30d"),[s,y]=t.useState({from:j(new Date,30),to:new Date}),[C,x]=t.useState(!1),[u,b]=t.useState([]),n=e=>new Intl.NumberFormat("id-ID").format(e),[M,v]=t.useState(0),[S,w]=t.useState(0),[D,N]=t.useState(0),k=e=>{g(e),e!=="custom"&&x(!1)};return t.useEffect(()=>{async function e(){const{data:T}=await B.get("/admin/sale/chart",{params:{time_range:i,start_date:p(s.from).format("YYYY-MM-DD"),end_date:p(s.to).format("YYYY-MM-DD")}}),o=T.data.map(r=>({date:r.date,sales:parseFloat(r.sales)})),f=o.reduce((r,F)=>r+parseFloat(F.sales),0),P=f/o.length,Y=Math.max(...o.map(r=>r.sales));v(f),w(P),N(Y),b(o)}e()},[i,s]),a.jsxs(c,{children:[a.jsx(m,{className:"pb-4",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[a.jsxs("div",{children:[a.jsx(d,{children:"Grafik Penjualan"}),a.jsx(h,{children:"Analisis penjualan berdasarkan rentang waktu"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[a.jsxs(G,{value:i,onValueChange:k,children:[a.jsx(J,{className:"w-[180px]",children:a.jsx(V,{placeholder:"Pilih rentang waktu"})}),a.jsx(X,{children:sa.map(e=>a.jsx(q,{value:e.value,children:e.label},e.value))})]}),i==="custom"&&a.jsxs(O,{open:C,onOpenChange:x,children:[a.jsx(A,{asChild:!0,children:a.jsxs(H,{variant:"outline",className:R("w-[280px] justify-start text-left font-normal",!s&&"text-muted-foreground"),children:[a.jsx(L,{className:"mr-2 h-4 w-4"}),s!=null&&s.from?s.to?a.jsxs(a.Fragment,{children:[l(s.from,"dd/MM/yyyy")," - ",l(s.to,"dd/MM/yyyy")]}):l(s.from,"dd/MM/yyyy"):a.jsx("span",{children:"Pilih tanggal"})]})}),a.jsx(I,{className:"w-auto p-0",align:"start",children:a.jsx(_,{initialFocus:!0,mode:"range",defaultMonth:s==null?void 0:s.from,selected:s,onSelect:e=>{y({from:(e==null?void 0:e.from)||j(new Date,30),to:(e==null?void 0:e.to)||new Date})},numberOfMonths:2})})]})]})]})}),a.jsxs(z,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[a.jsx(c,{className:"mb-6 w-100",children:a.jsxs(m,{className:"pb-2",children:[a.jsx(h,{children:"Total Penjualan"}),a.jsx(d,{className:"text-xl",children:n(M)})]})}),a.jsx(c,{className:"mb-6",children:a.jsxs(m,{className:"pb-2",children:[a.jsx(h,{children:"Rata-rata Harian"}),a.jsx(d,{className:"text-xl",children:n(S)})]})}),a.jsx(c,{className:"mb-6",children:a.jsxs(m,{className:"pb-2",children:[a.jsx(h,{children:"Penjualan Tertinggi"}),a.jsx(d,{className:"text-xl",children:n(D)})]})})]}),a.jsx("div",{className:"min-h-[300px]",children:a.jsx(E,{config:{sales:{label:"Penjualan",color:"hsl(var(--chart-1))"}},children:a.jsx(Q,{width:"100%",height:"100%",children:a.jsxs(U,{data:u,margin:{top:10,right:30,left:0,bottom:0},children:[a.jsx(W,{strokeDasharray:"3 3",vertical:!1}),a.jsx(Z,{dataKey:"date",tickFormatter:e=>u.length>30?l(new Date(e),"dd/MM"):l(new Date(e),"dd/MM/yyyy"),tick:{fontSize:12},tickMargin:0}),a.jsx(aa,{tickFormatter:e=>`${n(e/1e6)}Jt`,tick:{fontSize:12},tickMargin:0}),a.jsx(K,{content:a.jsx($,{formatter:e=>`${n(e/1e6)}Jt`,labelFormatter:e=>l(new Date(e),"dd MMMM yyyy")})}),a.jsx(ea,{dataKey:"sales",fill:"green",radius:[4,4,0,0]})]})})})})]})]})}export{Ca as default};
