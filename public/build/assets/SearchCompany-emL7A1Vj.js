import{r as d,j as a,a as h}from"./app-CQ-G37p-.js";import{B as S}from"./button-ymMXdPy5.js";import{I as p}from"./input-BXXA-PDa.js";import{S as E}from"./search-B9EA-nRY.js";function D({onChange:N,value:c}){const[n,r]=d.useState({id:"",code:"",name:""}),[o,l]=d.useState(!1),[i,t]=d.useState(""),u=d.useRef(!1);d.useRef(c),d.useEffect(()=>{c&&r({id:c.id||"",code:c.code||"",name:c.name||""})},[]),d.useEffect(()=>{N(n)},[n]);const g=e=>{r({...n,code:e.target.value}),j(e.target.value),t("")},v=e=>{r({...n,name:e.target.value}),j(e.target.value),t("")},f=async e=>{if(e.trim()){l(!0),t("");try{const{data:s}=await h.get(`/admin/company/search-by-code?search=${e}`);s.data?(u.current=!0,r({id:s.data.id,code:s.data.code,name:s.data.name})):t("Item not found")}catch(s){t("Failed to search company"),console.error(s)}finally{l(!1)}}},x=async e=>{if(e.trim()){l(!0),t("");try{const{data:s}=await h.get(`/admin/company/search-by-name?search=${e}`);s.data?(u.current=!0,r({id:s.data.id,code:s.data.code,name:s.data.name})):t("Item not found")}catch(s){t("Failed to search company"),console.error(s)}finally{l(!1)}}},b=e=>{e.key==="Enter"&&f(n.code)},C=e=>{e.key==="Enter"&&x(n.name)},w=()=>{n.code?f(n.code):n.name&&x(n.name)},[y,m]=d.useState([]),j=e=>{if(e.length<2){m([]);return}h.get(`/admin/company/list?search=${e}`).then(s=>{m(s.data.data)}).catch(s=>{console.error("Error fetching company:",s)})};return a.jsx("div",{className:"space-y-2 ",children:a.jsxs("div",{className:"relative",children:[a.jsxs("div",{className:"flex",children:[a.jsx("div",{className:"w-1/4",children:a.jsx(p,{className:"rounded-r-none",placeholder:"Kode Perusahaan",value:n.code,onChange:g,onKeyDown:b,disabled:o})}),a.jsx("div",{children:a.jsx(S,{className:"rounded-none",onClick:w,disabled:o,children:a.jsx(E,{className:"h-4 w-4"})})}),a.jsx("div",{className:"w-3/4",children:a.jsx(p,{className:"rounded-l-none",placeholder:"Nama Perusahaan",value:n.name,onChange:v,onKeyDown:C,disabled:o})})]}),a.jsx("div",{className:`absolute bg-blue-300 w-full p-2  ${y.length>0?"block z-10 shadow-sm rounded":"hidden"}`,children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left",children:"Kode"}),a.jsx("th",{className:"text-left",children:"Nama"})]})}),a.jsx("tbody",{children:y.map(e=>a.jsxs("tr",{className:"cursor-pointer hover:bg-blue-200",onClick:()=>{r({id:e.id,code:e.code,name:e.name}),m([])},children:[a.jsx("td",{children:e.code}),a.jsx("td",{children:e.name})]},e.id))})]})}),o&&a.jsx("div",{className:"text-sm text-muted-foreground",children:"Searching..."}),i&&a.jsx("div",{className:"text-sm text-destructive",children:i}),n.id&&!o&&!i&&a.jsxs("div",{className:"text-sm text-muted-foreground",children:["Company found: ",n.name]})]})})}export{D as S};
