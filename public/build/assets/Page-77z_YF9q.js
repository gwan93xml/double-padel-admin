import{r as x,j as i}from"./app-CQ-G37p-.js";import{h as d}from"./moment-C5S46NFB.js";import{R as b}from"./report-list-CoUR2Q-E.js";import{I as s}from"./input-BXXA-PDa.js";import{B as j}from"./button-ymMXdPy5.js";import{F as n}from"./form-group-CHZXn8bM.js";import{S as y}from"./SearchVendor-DVTa9TJs.js";import{C as a}from"./currency-formatter-D5vTOkIG.js";import{A as k}from"./AuthenticatedLayout-X6euxa7E.js";import{D as C}from"./DivisionList-Dge3XhOp.js";import{S as D}from"./search-B9EA-nRY.js";import"./table-BSdxGOLt.js";import"./createLucideIcon-iWXofaGH.js";import"./card-Bq41eL_q.js";import"./list-DIayZXqH.js";import"./filter-BZN7rDIQ.js";import"./file-text-vhY6aTSF.js";import"./file-spreadsheet-Dv5Qp-1R.js";import"./index-D0iIn24t.js";import"./label-Blk7FhF1.js";import"./index-DqZ46QiR.js";import"./loader-circle-i2ANfqrZ.js";import"./x-D2Pel9EU.js";import"./index-BHS3gC_j.js";import"./index-B9C1SM0Q.js";import"./tslib.es6-eMSY344_.js";import"./index-uJ2KZHf0.js";import"./index-C7S3ohsj.js";import"./index-B9VoEdXn.js";import"./can-DARgw7Bo.js";import"./chevron-right-DWL5tPD-.js";import"./use-toast-XJEkqv7A.js";import"./badge-CsIJHFj0.js";import"./triangle-alert-byTh5Szo.js";import"./calendar-BV_-Gsoc.js";import"./checkbox-DaA1krf_.js";import"./index-CZ_DqijM.js";import"./command-BCd-qebN.js";import"./dialog-CBBIkam9.js";import"./popover-BMGWAYFn.js";import"./chevron-down-BOk5s691.js";function F(){const[l,m]=x.useState([]),p={monthFrom:d().format("YYYY-MM"),monthTo:d().format("YYYY-MM"),divisions:[],vendor_id:void 0,vendor:void 0},h=[{header:"No",key:"no",renderCell:(e,r)=>r+1},{header:"Invoice",key:"invoice",renderCell:e=>i.jsx("a",{href:`/admin/purchase/${e.id}/edit`,className:"text-blue-600 hover:underline",target:"_blank",children:e.invoice_number})},{header:"Tanggal",key:"date",renderCell:e=>d(e.purchase_date).format("DD/MM/YYYY")},{header:"Divisi",key:"division",renderCell:e=>{var r;return((r=e.division)==null?void 0:r.name)??"-"}},{header:"Vendor",key:"vendor",renderCell:e=>{var r;return((r=e.vendor)==null?void 0:r.name)??"-"}},{header:"Harga",key:"subtotal",align:"right",renderCell:e=>i.jsx(a,{amount:Number(e.subtotal)}),renderFooter:e=>e.reduce((r,t)=>r+parseFloat(String(t.subtotal)),0).toLocaleString("id-ID")},{header:"Diskon",key:"discount",align:"right",renderCell:e=>i.jsx(a,{amount:Number(e.discount)+Number(e.purchase_discount)}),renderFooter:e=>e.reduce((r,t)=>r+parseFloat(String(t.discount))+parseFloat(String(t.purchase_discount)),0).toLocaleString("id-ID")},{header:"Pajak",key:"tax",align:"right",renderCell:e=>i.jsx(a,{amount:Number(e.tax)}),renderFooter:e=>e.reduce((r,t)=>r+parseFloat(String(t.tax)),0).toLocaleString("id-ID")},{header:"By. Kirim",key:"shipping",align:"right",renderCell:e=>i.jsx(a,{amount:Number(e.shipping_cost)}),renderFooter:e=>e.reduce((r,t)=>r+parseFloat(String(t.shipping_cost)),0).toLocaleString("id-ID")},{header:"Materai",key:"stamp",align:"right",renderCell:e=>i.jsx(a,{amount:Number(e.stamp_duty)}),renderFooter:e=>e.reduce((r,t)=>r+parseFloat(String(t.stamp_duty)),0).toLocaleString("id-ID")},{header:"Total",key:"total",align:"right",renderCell:e=>i.jsx(a,{amount:Number(e.total_amount)}),renderFooter:e=>e.reduce((r,t)=>r+parseFloat(String(t.total_amount)),0).toLocaleString("id-ID")}],u={rowKey:e=>e.id,getDetails:e=>e.items??[],columns:[{header:"Qty / Unit",key:"qty",width:"w-24",renderCell:e=>`${e.quantity} ${e.unit??""}`},{header:"Nama Item",key:"name",width:"w-64",renderCell:e=>{var r;return((r=e.item)==null?void 0:r.name)??e.item_name}},{header:"Harga",key:"price",align:"right",width:"w-32",renderCell:e=>i.jsx(a,{amount:Number(e.price)})},{header:"Subtotal",key:"subtotal",align:"right",width:"w-32",renderCell:e=>i.jsx(a,{amount:Number(e.subtotal)})},{header:"Disc",key:"disc",align:"right",width:"w-24",renderCell:e=>i.jsx(a,{amount:Number(e.discount)})},{header:"Total",key:"total",align:"right",width:"w-32",renderCell:e=>i.jsx(a,{amount:Number(e.total)})}]};function c(e){let r=`/admin/purchase-detail-report/export/pdf?monthFrom=${e.monthFrom}&monthTo=${e.monthTo}`;return e.divisions&&e.divisions.length>0&&e.divisions.forEach((t,o)=>{r+=`&divisions[${o}][id]=${t.id}`}),e.vendor_id&&(r+=`&vendor_id=${e.vendor_id}`),r}function g(e){let r=`/admin/purchase-detail-report/export/excel?monthFrom=${e.monthFrom}&monthTo=${e.monthTo}`;return e.divisions&&e.divisions.length>0&&e.divisions.forEach((t,o)=>{r+=`&divisions[${o}][id]=${t.id}`}),e.vendor_id&&(r+=`&vendor_id=${e.vendor_id}`),r}return i.jsx(b,{title:"Laporan Pembelian Detail",description:"Daftar transaksi pembelian detail berdasarkan filter waktu, vendor, dan divisi",fetchUrl:"/admin/purchase-detail-report/list",exportPdfUrl:c,exportExcelUrl:g,initialFilters:p,renderFilter:(e,r,t)=>i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-4 items-end",children:[i.jsx("div",{className:"lg:col-span-4",children:i.jsx(n,{label:"Divisi",children:i.jsx(C,{selectedDivisions:l||[],onSelectionChange:o=>{m(o),r({...e,divisions:o.map(v=>({id:v.id}))})}})})}),i.jsx("div",{className:"lg:col-span-4",children:i.jsx(n,{label:"Vendor",children:i.jsx(y,{value:e.vendor,onChange:o=>r({...e,vendor:o,vendor_id:o.id}),clearable:!0})})}),i.jsx("div",{className:"lg:col-span-2",children:i.jsx(n,{label:"Dari Bulan",children:i.jsx(s,{type:"month",value:e.monthFrom,onChange:o=>r({...e,monthFrom:o.target.value})})})}),i.jsx("div",{className:"lg:col-span-2",children:i.jsx(n,{label:"Hingga Bulan",children:i.jsx(s,{type:"month",value:e.monthTo,onChange:o=>r({...e,monthTo:o.target.value})})})}),i.jsx("div",{className:"lg:col-span-12 flex justify-end gap-2 mt-4",children:i.jsxs(j,{onClick:t,className:"bg-blue-600 hover:bg-blue-700",children:[i.jsx(D,{className:"h-4 w-4 mr-2"})," Tampilkan"]})})]}),columns:h,detailInline:u})}F.layout=l=>i.jsx(k,{breadcrumbs:[{label:"Dashboard",href:"/admin/"},{label:"Laporan",href:"#"},{label:"Pembelian Detail",href:"#"}],children:l});export{F as default};
