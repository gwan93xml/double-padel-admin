import{r as i,j as e,a as N}from"./app-CQ-G37p-.js";import{S as I}from"./SearchChartOfAccount-0Jd4yGJY.js";import{S as D}from"./SearchDivision-Budjprvk.js";import{B as _}from"./button-ymMXdPy5.js";import{I as f}from"./input-BXXA-PDa.js";import{D as R,a as A,b as M,c as Y}from"./dialog-CBBIkam9.js";import{T as G,a as L,b as C,c as l,d as P}from"./table-BSdxGOLt.js";import{h as H}from"./moment-C5S46NFB.js";import{C as K}from"./currency-formatter-D5vTOkIG.js";import{S as w}from"./search-B9EA-nRY.js";import{F as $}from"./folder-BoHnSs8n.js";import{S as V}from"./SearchSalesOrder-ByXoXUsQ.js";import{S as Q}from"./SearchCustomer-BbTZ5_2l.js";import{F as c}from"./form-group-CHZXn8bM.js";import{M as U}from"./money-input-Bb590VQ4.js";import{T as z}from"./textarea-BvykTLwI.js";import{Y as J}from"./YesNo-XNzDhSSn.js";import"./card-Bq41eL_q.js";import"./createLucideIcon-iWXofaGH.js";import"./badge-CsIJHFj0.js";import"./loader-circle-i2ANfqrZ.js";import"./x-D2Pel9EU.js";import"./file-text-vhY6aTSF.js";import"./index-D0iIn24t.js";import"./index-BHS3gC_j.js";import"./index-B9C1SM0Q.js";import"./index-DqZ46QiR.js";import"./tslib.es6-eMSY344_.js";import"./index-uJ2KZHf0.js";import"./label-Blk7FhF1.js";function W({onChange:r,value:o,vendorId:a}){const[t,m]=i.useState({id:"",number:""}),[u,x]=i.useState(!1),[j,h]=i.useState(""),s=i.useRef(!1);i.useRef(o),i.useEffect(()=>{o&&m({id:o.id||"",number:o.number||""})},[]),i.useEffect(()=>{r(t)},[t]);const y=n=>{m({...t,number:n.target.value}),h("")},g=async n=>{if(n.trim()){x(!0),h("");try{const{data:d}=await N.get(`/admin/purchase/search-by-number?search=${n}`);d.data?(s.current=!0,m({id:d.data.id,number:d.data.number})):h("Sales order not found")}catch(d){h("Failed to search purchase order"),console.error(d)}finally{x(!1)}}},T=n=>{n.key==="Enter"&&g(t.number)},B=()=>{t.number&&g(t.number)},[O,b]=i.useState(!1),[v,F]=i.useState(""),[k,q]=i.useState([]),E=()=>{b(!0),p()},p=async()=>{try{const n=await N.get(`/admin/purchase/list?search=${v}&vendor_id=${a}`);q(n.data.data)}catch(n){console.error(n)}};return i.useEffect(()=>{p()},[]),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-full",children:e.jsx(f,{className:"rounded-r-none",placeholder:"Nomor Sales ",value:t.number,onChange:y,onKeyDown:T,disabled:u})}),e.jsxs("div",{className:"flex",children:[e.jsx(_,{className:"rounded-none",onClick:B,disabled:u,children:e.jsx(w,{className:"h-4 w-4"})}),e.jsx(_,{className:"rounded-none",onClick:E,disabled:u,children:e.jsx($,{className:"h-4 w-4"})})]})]}),u&&e.jsx("div",{className:"text-sm text-muted-foreground",children:"Searching..."}),j&&e.jsx("div",{className:"text-sm text-destructive",children:j}),e.jsx(R,{open:O,onOpenChange:b,children:e.jsxs(A,{className:"min-w-[70%]",children:[e.jsx(M,{children:e.jsx(Y,{children:"Browse Sales "})}),e.jsxs("div",{className:"flex",children:[e.jsx(f,{className:"rounded-r-none",value:v,onChange:n=>F(n.target.value)}),e.jsx(_,{className:"rounded-l-none",onClick:p,children:e.jsx(w,{className:"h-4 w-4"})})]}),e.jsxs(G,{children:[e.jsx(L,{children:e.jsxs(C,{children:[e.jsx(l,{children:"NOMOR"}),e.jsx(l,{children:"NOMOR PO"}),e.jsx(l,{children:"DIVISI"}),e.jsx(l,{children:"TANGGAL"}),e.jsx(l,{children:"PELANGGAN"}),e.jsx(l,{children:"TOTAL"})]})}),e.jsx(P,{children:k.map(n=>{var d,S;return e.jsxs(C,{onClick:()=>{m(n),b(!1)},className:"cursor-pointer hover:bg-muted",children:[e.jsx(l,{children:n.number}),e.jsx(l,{children:(d=n.division)==null?void 0:d.name}),e.jsx(l,{children:H(n.sale_date).format("DD/MM/YYYY")}),e.jsx(l,{children:(S=n.customer)==null?void 0:S.name}),e.jsx(l,{children:e.jsx(K,{amount:parseFloat(n.total_amount??"0")})})]},n.id)})})]})]})})]})}function Be({data:r,setData:o,errors:a}){var t,m,u,x,j,h;return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-x-4  gap-y-4",children:[e.jsx(c,{label:"Divisi",error:a.division_id,name:"division_id",children:e.jsx(D,{value:{id:r.division_id,code:(t=r.division)==null?void 0:t.code,name:(m=r.division)==null?void 0:m.name},onChange:s=>{o({...r,division_id:s.id,division:{id:s.id,code:s.code,name:s.name}})}})}),e.jsx(c,{label:"P/O",required:!0,error:a.sales_order_number,children:e.jsx(V,{value:{number:r.sales_order_number},onChange:s=>{o({...r,sales_order_number:s.number})}})}),e.jsx(c,{label:"Penjualan",error:a.sales_number,children:e.jsx(W,{value:{number:r.sales_number},onChange:s=>{o({...r,sales_number:s.number})}})}),e.jsx(c,{label:"Refund",required:!0,error:a.sales_number,children:e.jsx(J,{value:r.is_refund??!1,onChange:s=>{o({...r,is_refund:s})}})}),e.jsx(c,{label:"Customer",required:!0,error:a.customer_id,children:e.jsx(Q,{value:{id:r.customer_id,name:(u=r.customer)==null?void 0:u.name,code:(x=r.customer)==null?void 0:x.code},onChange:s=>{o({...r,customer_id:s.id,customer:s})}})}),e.jsx(c,{label:"Nomor",required:!0,error:a.number,children:e.jsx(f,{type:"text",disabled:!0,value:r.number??"???"})}),e.jsx(c,{label:"Tanggal",required:!0,error:a.date,children:e.jsx(f,{type:"date",value:r.date,onChange:s=>{o("date",s.target.value)}})}),e.jsx(c,{label:"Deposit",required:!0,error:a.amount,children:e.jsx(U,{value:r.amount,onValueChange:s=>{o({...r,amount:s})}})}),e.jsx(c,{label:"Deposit Ke Perkiraan",required:!0,error:a.chart_of_account_id,children:e.jsx(I,{value:{id:r.chart_of_account_id??0,code:(j=r.chart_of_account)==null?void 0:j.code,name:(h=r.chart_of_account)==null?void 0:h.name},onChange:s=>{o({...r,chart_of_account_id:s.id,chart_of_account:s})}})}),e.jsx(c,{label:"Catatan",error:a.notes,children:e.jsx(z,{rows:5,value:r.notes,onChange:s=>{o({...r,notes:s.target.value})}})})]})})}export{Be as default};
