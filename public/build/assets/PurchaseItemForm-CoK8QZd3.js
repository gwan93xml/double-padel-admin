import{r as l,j as o}from"./app-CQ-G37p-.js";import{S as E}from"./SearchChartOfAccount-0Jd4yGJY.js";import{S as q}from"./SearchItem-DGpcvLrN.js";import{S as I}from"./SearchItemNonStock-BQ2Ydllm.js";import{S as K}from"./SearchSubUnit-CTrUekdR.js";import{B as C}from"./button-ymMXdPy5.js";import{D as T,a as V,b as B,c as H,d as M}from"./dialog-CBBIkam9.js";import{F as s}from"./form-group-CHZXn8bM.js";import{I as f}from"./input-BXXA-PDa.js";import{M as u}from"./money-input-Bb590VQ4.js";import{T as P}from"./textarea-BvykTLwI.js";import"./card-Bq41eL_q.js";import"./createLucideIcon-iWXofaGH.js";import"./badge-CsIJHFj0.js";import"./loader-circle-i2ANfqrZ.js";import"./search-B9EA-nRY.js";import"./x-D2Pel9EU.js";import"./file-text-vhY6aTSF.js";import"./package-Cd0mGsRo.js";import"./select-BSIJzAmS.js";import"./index-B9C1SM0Q.js";import"./index-DqZ46QiR.js";import"./index-D0iIn24t.js";import"./tslib.es6-eMSY344_.js";import"./index-C7S3ohsj.js";import"./index-B9VoEdXn.js";import"./index-CZ_DqijM.js";import"./chevron-down-BOk5s691.js";import"./index-BHS3gC_j.js";import"./index-uJ2KZHf0.js";import"./label-Blk7FhF1.js";function ge({warehouse_id:N,formDialog:m,onOpenChange:h,data:e,setData:r,errors:i,onSave:x}){var k,R,v,S;l.useRef([]);const p=l.useRef(null),_=l.useRef(null),g=l.useRef(null),a=l.useRef(null),j=l.useRef(null),b=l.useRef(null),d=l.useRef(null);l.useRef(null);const y=l.useRef(null),F=l.useRef(null);return o.jsx(T,{open:m.open,onOpenChange:h,children:o.jsxs(V,{className:" max-h-[80vh] overflow-y-auto",children:[o.jsx(B,{children:o.jsx(H,{children:m.isEdit?"Edit Item":"Tambahkan item"})}),o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex border border-gray-200 shadow-sm rounded justify-stretch",children:[o.jsx("div",{className:`flex-1 p-2 text-center border-r cursor-pointer font-bold " ${e.is_stock?"bg-blue-600 rounded-l text-white":""}`,onClick:()=>{r({...e,is_stock:!0})},children:"STOCK"}),o.jsx("div",{className:`flex-1 p-2 text-center cursor-pointer font-bold ${e.is_stock?"":"bg-blue-600 rounded-r text-white"}`,onClick:()=>{r({...e,is_stock:!1})},children:"NON STOCK"})]}),e.is_stock?o.jsx(s,{label:"Item",error:i.item_name,name:"item_id",required:!0,children:o.jsx(q,{warehouseId:N,value:{id:e.item_id??"",code:((k=e.item)==null?void 0:k.code)??"",name:((R=e.item)==null?void 0:R.name)??"",purchase_price:(e==null?void 0:e.price)??"0",selling_price:(e==null?void 0:e.price)??"0",unit:(e==null?void 0:e.unit)??"",description:e.notes},onChange:n=>{r({...e,item_id:n.id,item_name:n.name,price:n.purchase_price??0,item:{code:n.code,name:n.name},notes:n.description})},nextRef:p})}):null,e.is_stock?null:o.jsxs(o.Fragment,{children:[o.jsx(s,{label:"Item Non Stock",error:i.item_name,name:"item_name",required:!0,children:o.jsx(I,{value:{id:e.item_id??"",item_name:e.item_name??"",price:(e==null?void 0:e.price)??"0",unit:(e==null?void 0:e.unit)??"",description:e.notes},onChange:n=>{r({...e,item_id:n.id,item_name:n.item_name,price:n.price??0,item:{code:n.item_name,name:n.name},notes:n.description,unit:n.unit??""})},nextRef:y})}),o.jsx(s,{label:"Akun",error:i.chart_of_account_id,name:"chart_of_account_id",children:o.jsx(E,{accountCodeRef:y,nextRef:p,value:{id:e.chart_of_account_id??"0",code:((v=e.chart_of_account)==null?void 0:v.code)??"",name:((S=e.chart_of_account)==null?void 0:S.name)??""},onChange:n=>{r({...e,chart_of_account_id:n.id,chart_of_account:{code:n.code,name:n.name}})}})})]}),o.jsx(s,{label:"Harga",error:i.price,name:"price",children:o.jsx(u,{ref:p,onKeyDown:n=>{var t;n.key==="Enter"&&((t=_.current)==null||t.focus())},value:e.price,onValueChange:n=>{r({...e,price:n,subtotal:(parseFloat(n)*parseFloat(e.quantity)).toString(),total:(parseFloat(n)*parseFloat(e.quantity)-parseFloat(e.discount??"0")).toString()})}})}),o.jsx(s,{label:"Jumlah",error:i.quantity,name:"quantity",children:o.jsx(f,{ref:_,type:"number",value:e.quantity,className:"text-right",onFocus:n=>{n.target.select()},onChange:n=>{r({...e,quantity:n.target.value,subtotal:(parseFloat(e.price??"0")*parseFloat(n.target.value)).toString(),total:(parseFloat(e.price??"0")*parseFloat(n.target.value)-parseFloat(e.discount??"0")).toString()})},onKeyDown:n=>{var t,c;n.key==="Enter"&&(e.is_stock?(t=g.current)==null||t.focus():(c=F.current)==null||c.focus())}})}),e.is_stock?o.jsx(s,{label:"Satuan",error:i.unit,required:!0,children:o.jsx(K,{ref:g,value:e.unit,itemId:e.item_id,onChange:n=>{r("unit",n),setTimeout(()=>{var t;(t=a.current)==null||t.focus()},100)}})}):o.jsx(s,{label:"Satuan",error:i.unit,name:"unit",children:o.jsx(f,{ref:F,type:"text",value:e.unit,onChange:n=>{r({...e,unit:n.target.value})},onKeyDown:n=>{var t;n.key==="Enter"&&((t=a.current)==null||t.focus())}})}),o.jsx(s,{label:"Subtotal",error:i.subtotal,name:"subtotal",children:o.jsx(u,{ref:a,value:e.subtotal,className:"text-right",onValueChange:n=>{r({...e,subtotal:n,price:(parseFloat(n)/parseFloat(e.quantity??"1")).toString(),total:(parseFloat(n)-parseFloat(e.discount??"0")).toString()})},onKeyDown:n=>{var t;n.key==="Enter"&&((t=j.current)==null||t.focus())}})}),o.jsxs("div",{className:"flex",children:[o.jsx("div",{className:"w-3/4",children:o.jsx(s,{label:"Discount",error:i.discount,name:"discount",children:o.jsx(u,{ref:j,value:e.discount,className:"text-right",onValueChange:n=>{r({...e,discount:n,discount_percent:0,total:(parseFloat(e.subtotal)-parseFloat(n)).toString()})},onKeyDown:n=>{var t;n.key==="Enter"&&((t=b.current)==null||t.focus())}})})}),o.jsx("div",{className:"w-1/4",children:o.jsx(s,{label:"%",error:i.discount,name:"discount",children:o.jsx(f,{ref:b,type:"number",value:e.discount_percent,className:"text-right",onChange:n=>{const t=parseFloat(e.subtotal??"0"),c=(t*parseFloat(n.target.value)/100).toFixed(2),w=(t-parseFloat(c)).toFixed(2);r({...e,discount_percent:n.target.value,discount:c,total:w})},onFocus:n=>{n.target.select()},onKeyDown:n=>{var t;n.key==="Enter"&&((t=d.current)==null||t.focus())}})})})]}),o.jsx(s,{label:"Total",error:i.total,name:"total",children:o.jsx(u,{value:e.total,disabled:!0,className:"text-right",onValueChange:n=>{}})}),o.jsx(s,{label:"Catatan",error:i.notes,name:"notes",children:o.jsx(P,{ref:d,value:e.notes,onChange:n=>{r({...e,notes:n.target.value})},onKeyDown:n=>{n.key==="Enter"&&(n.preventDefault(),x(!0))}})})]}),o.jsxs(M,{children:[o.jsx(C,{type:"button",variant:"outline",onClick:()=>{h()},children:"Batal"}),o.jsx(C,{type:"button",onClick:()=>x(!1),children:m.isEdit?"Edit":"Tambah"})]})]})})}export{ge as default};
