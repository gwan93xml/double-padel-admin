import{r,a as j,y as m,R as C,j as o}from"./app-CQ-G37p-.js";import{A as k}from"./AuthenticatedLayout-X6euxa7E.js";import{C as N}from"./card-Bq41eL_q.js";import{I as _}from"./input-BXXA-PDa.js";import{B as v}from"./button-ymMXdPy5.js";import w from"./TreeNode-Camo_9IC.js";import{S as A}from"./search-B9EA-nRY.js";import"./index-D0iIn24t.js";import"./createLucideIcon-iWXofaGH.js";import"./index-DqZ46QiR.js";import"./index-BHS3gC_j.js";import"./index-B9C1SM0Q.js";import"./tslib.es6-eMSY344_.js";import"./index-uJ2KZHf0.js";import"./x-D2Pel9EU.js";import"./index-C7S3ohsj.js";import"./index-B9VoEdXn.js";import"./can-DARgw7Bo.js";import"./chevron-right-DWL5tPD-.js";import"./use-toast-XJEkqv7A.js";import"./badge-CsIJHFj0.js";import"./currency-formatter-D5vTOkIG.js";import"./moment-C5S46NFB.js";import"./triangle-alert-byTh5Szo.js";import"./calendar-BV_-Gsoc.js";import"./dialog-CBBIkam9.js";import"./AccountForm-Ko5kIEWr.js";import"./index-BiiFumPK.js";import"./form-group-CHZXn8bM.js";import"./label-Blk7FhF1.js";import"./chevron-down-BOk5s691.js";import"./file-text-vhY6aTSF.js";import"./plus-gEoqNGty.js";import"./square-pen-Pz9x-bS-.js";import"./trash-2-CvcuuDsN.js";function I(){const[s,n]=r.useState(null),[a,d]=r.useState(!1),c=r.useCallback(async()=>{d(!0);try{const l=await j.get("/admin/chart-of-account/list");n({id:"root",code:"0",name:"Kode Perkiraan",type:"Asset",sub_type:"cash",dr_cr:"Debit",children:l.data.data})}catch(l){console.error("Failed to load chart of accounts",l)}finally{d(!1)}},[]);return r.useEffect(()=>{c()},[c]),{tree:s,loading:a,reload:c,setTree:n}}function T(){var p;r.useState(0);const{tree:s,loading:n,reload:a,setTree:d}=I(),[c,l]=r.useState(""),[f,x]=r.useState(new Set(["root"])),S=r.useCallback(()=>{a()},[m,a]),y=r.useCallback(()=>{a()},[m,a]),b=r.useCallback((e,t=!1)=>{t?m.delete(`/admin/chart-of-account/${e}/force-delete`,{onSuccess:a}):m.delete(`/admin/chart-of-account/${e}`,{onSuccess:a})},[m,a]),i=C.useMemo(()=>{if(!c||!s)return s;const e=t=>{var h;const g=t.name.toLowerCase().includes(c)||t.code.includes(c),u=(h=t.children)==null?void 0:h.map(e).filter(Boolean);return g||u.length?{...t,children:u}:null};return e(s)},[c,s]);return r.useEffect(()=>{const e=localStorage.getItem("chart_of_account_scroll");if(e){const t=document.querySelector("[data-scroll-container]");t&&(t.scrollTop=parseInt(e,10))}},[s]),o.jsxs("div",{className:"p-4",children:[o.jsxs("div",{className:"flex items-center mb-4 space-x-2",children:[o.jsx(_,{placeholder:"Filter kode atau nama...",value:c,onChange:e=>l(e.target.value.toLowerCase()),className:"max-w-sm"}),o.jsx(v,{onClick:a,children:o.jsx(A,{className:"w-4 h-4"})})]}),o.jsxs(N,{className:"p-2 ",children:[n&&o.jsx("p",{className:"text-center py-8",children:"Memuat..."}),!n&&i&&o.jsx("div",{"data-scroll-container":!0,className:"h-[80vh] overflow-y-auto p-4  ",onScroll:()=>{const e=document.querySelector("[data-scroll-container]");if(e){const t=e.scrollTop;localStorage.setItem("chart_of_account_scroll",t.toString())}},children:o.jsx(w,{node:i,onAdd:S,onEdit:y,onDelete:b,openIds:f,setOpenIds:x})}),!n&&!((p=i==null?void 0:i.children)!=null&&p.length)&&o.jsx("p",{className:"text-center py-8",children:"Tidak ada akun."})]})]})}T.layout=s=>o.jsx(k,{breadcrumbs:[{label:"Dashboard",href:"/admin"},{label:"Akuntansi",href:"#"},{label:"Kode Perkiraan",href:"#"}],children:s});export{T as default};
