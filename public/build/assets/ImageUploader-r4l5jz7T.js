import{r as o,j as e,a as w}from"./app-xdIDsNuc.js";import{B as k}from"./index-D9fYs-5N.js";import{c as U}from"./createLucideIcon-D9qBrcbq.js";import{X as C}from"./x-Cp6Dz_ky.js";import{C as M}from"./check-B2a_CU3u.js";/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=U("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);function q({onSuccess:f,onError:p,className:D="",label:b="Upload Gambar",initialValue:n=null,maxHeight:g}){const[h,c]=o.useState(n),[v,j]=o.useState(!1),[N,x]=o.useState(null),[L,i]=o.useState(!1),[G,m]=o.useState(!!n),d=o.useRef(null);o.useEffect(()=>{n&&(c(n),m(!0))},[n]);const I=async a=>{var s;const r=(s=a.target.files)==null?void 0:s[0];if(!r)return;x(null),i(!1),m(!1);const l=new FileReader;l.onload=t=>{var u;c((u=t.target)==null?void 0:u.result)},l.readAsDataURL(r),await y(r)},y=async a=>{var r,l;j(!0);try{const s=new FormData;s.append("image",a);const t=await w.post("/upload/image",s,{headers:{"X-Requested-With":"XMLHttpRequest"}});i(!0),f==null||f(t.data.data.url,t.data.data.filename),setTimeout(()=>{i(!1),c(t.data.data.url),m(!1),d.current&&(d.current.value="")},2e3)}catch(s){const t=w.isAxiosError(s)?((l=(r=s.response)==null?void 0:r.data)==null?void 0:l.message)||"Gagal mengunggah gambar":s instanceof Error?s.message:"Gagal mengunggah gambar";x(t),p==null||p(t),c(null)}finally{j(!1)}},R=a=>{a.preventDefault(),a.currentTarget.classList.add("bg-blue-50","border-blue-300")},P=a=>{a.currentTarget.classList.remove("bg-blue-50","border-blue-300")},F=async a=>{var s;a.preventDefault(),a.currentTarget.classList.remove("bg-blue-50","border-blue-300");const r=(s=a.dataTransfer.files)==null?void 0:s[0];if(!r)return;x(null),i(!1),m(!1);const l=new FileReader;l.onload=t=>{var u;c((u=t.target)==null?void 0:u.result)},l.readAsDataURL(r),await y(r)};return e.jsxs("div",{className:D,children:[b&&e.jsx("label",{className:"block text-sm font-semibold mb-2",children:b}),e.jsx("input",{ref:d,type:"file",accept:"image/*",onChange:I,className:"hidden"}),h?e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"relative w-full aspect-video rounded-lg overflow-hidden border border-gray-200 bg-gray-100",style:g?{maxHeight:`${g}px`}:{},children:e.jsx("img",{src:h,alt:"Preview",className:"h-full object-center",style:g?{maxHeight:`${g}px`}:{}})}),v&&e.jsxs("div",{className:"flex items-center justify-center gap-2 text-blue-600",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-blue-200 border-t-blue-600 rounded-full animate-spin"}),e.jsx("span",{className:"text-sm font-medium",children:"Mengunggah..."})]}),N&&e.jsxs("div",{className:"flex items-start gap-2 bg-red-50 border border-red-200 rounded-lg p-3",children:[e.jsx(C,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-red-800",children:"Upload Gagal"}),e.jsx("p",{className:"text-xs text-red-700 mt-1",children:N})]})]}),L&&e.jsxs("div",{className:"flex items-center gap-2 bg-green-50 border border-green-200 rounded-lg p-3",children:[e.jsx(M,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-green-800",children:"Gambar berhasil diunggah"})]}),!v&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(k,{variant:"outline",onClick:()=>{c(n||null),m(!!n),x(null),i(!1),d.current&&(d.current.value="")},className:"flex-1",children:G?"Batalkan Perubahan":"Batal"}),e.jsx(k,{onClick:()=>{var a;return(a=d.current)==null?void 0:a.click()},className:"flex-1",children:"Pilih Gambar Lain"})]})]}):e.jsxs("div",{onClick:()=>{var a;return(a=d.current)==null?void 0:a.click()},onDragOver:R,onDragLeave:P,onDrop:F,className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center cursor-pointer transition-colors hover:border-blue-400 hover:bg-blue-50",children:[e.jsx(B,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-sm font-semibold text-gray-700 mb-1",children:"Drag gambar di sini atau klik untuk memilih"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Format: JPEG, PNG, JPG, GIF, WebP (Max 5MB)"})]})]})}export{q as I};
