import{r as b,j as t}from"./app-CQ-G37p-.js";import{h as s}from"./moment-C5S46NFB.js";import{R as j}from"./report-list-CoUR2Q-E.js";import{I as d}from"./input-BXXA-PDa.js";import{B as v}from"./button-ymMXdPy5.js";import{F as n}from"./form-group-CHZXn8bM.js";import{S as w}from"./SearchCustomer-BbTZ5_2l.js";import{C as a}from"./currency-formatter-D5vTOkIG.js";import{A as y}from"./AuthenticatedLayout-X6euxa7E.js";import{D as k}from"./DivisionList-Dge3XhOp.js";import{S as C}from"./search-B9EA-nRY.js";import"./table-BSdxGOLt.js";import"./createLucideIcon-iWXofaGH.js";import"./card-Bq41eL_q.js";import"./list-DIayZXqH.js";import"./filter-BZN7rDIQ.js";import"./file-text-vhY6aTSF.js";import"./file-spreadsheet-Dv5Qp-1R.js";import"./index-D0iIn24t.js";import"./label-Blk7FhF1.js";import"./index-DqZ46QiR.js";import"./loader-circle-i2ANfqrZ.js";import"./x-D2Pel9EU.js";import"./index-BHS3gC_j.js";import"./index-B9C1SM0Q.js";import"./tslib.es6-eMSY344_.js";import"./index-uJ2KZHf0.js";import"./index-C7S3ohsj.js";import"./index-B9VoEdXn.js";import"./can-DARgw7Bo.js";import"./chevron-right-DWL5tPD-.js";import"./use-toast-XJEkqv7A.js";import"./badge-CsIJHFj0.js";import"./triangle-alert-byTh5Szo.js";import"./calendar-BV_-Gsoc.js";import"./checkbox-DaA1krf_.js";import"./index-CZ_DqijM.js";import"./command-BCd-qebN.js";import"./dialog-CBBIkam9.js";import"./popover-BMGWAYFn.js";import"./chevron-down-BOk5s691.js";function N(){const[l,m]=b.useState([]),u={monthFrom:s().format("YYYY-MM"),monthTo:s().format("YYYY-MM"),divisions:[],customer:void 0,customer_id:void 0},c=[{header:"No",key:"no",width:"w-12",renderCell:(e,r)=>r+1},{header:"No. Faktur",key:"invoice",width:"w-32",renderCell:e=>t.jsx("a",{href:`/admin/sale/${e.id}/edit`,className:"text-blue-600 hover:underline",target:"_blank",children:e.no})},{header:"No. PO",key:"purchase_order",width:"w-32",renderCell:e=>e.purchase_order_number??"-"},{header:"Tanggal",key:"date",width:"w-28",renderCell:e=>s(e.sale_date).format("DD/MM/YYYY")},{header:"Divisi",key:"division",width:"w-48",renderCell:e=>{var r,i;return((r=e.division)==null?void 0:r.code)+" "+((i=e.division)==null?void 0:i.name)}},{header:"Pelanggan",key:"customer",width:"w-48",renderCell:e=>{var r,i;return((r=e.customer)==null?void 0:r.code)+" "+((i=e.customer)==null?void 0:i.name)}},{header:"Harga",key:"subtotal",align:"right",renderCell:e=>t.jsx(a,{amount:Number(e.subtotal)}),renderFooter:e=>e.reduce((r,i)=>r+parseFloat(String(i.subtotal)),0).toLocaleString("id-ID")},{header:"Diskon",key:"discount",align:"right",renderCell:e=>t.jsx(a,{amount:Number(e.discount)+Number(e.sales_discount)}),renderFooter:e=>e.reduce((r,i)=>r+parseFloat(String(i.discount)+String(i.sales_discount)),0).toLocaleString("id-ID")},{header:"Pajak",key:"tax",align:"right",renderCell:e=>t.jsx(a,{amount:Number(e.tax)}),renderFooter:e=>e.reduce((r,i)=>r+parseFloat(String(i.tax)),0).toLocaleString("id-ID")},{header:"Total",key:"total",align:"right",renderCell:e=>t.jsx(a,{amount:Number(e.total_amount)}),renderFooter:e=>e.reduce((r,i)=>r+parseFloat(String(i.total_amount)),0).toLocaleString("id-ID")}],h={rowKey:(e,r)=>`${e.id}-${r}`,getDetails:e=>e.items??[],columns:[{header:"Qty / Unit",key:"qty",width:"w-24",renderCell:e=>`${e.quantity} ${e.unit??""}`},{header:"Nama Item",key:"name",width:"w-64",renderCell:e=>{var r;return((r=e.item)==null?void 0:r.name)??e.item_name}},{header:"Harga",key:"price",width:"w-32",align:"right",renderCell:e=>t.jsx(a,{amount:Number(e.price)})},{header:"Subtotal",key:"subtotal",width:"w-32",align:"right",renderCell:e=>t.jsx(a,{amount:Number(e.subtotal)})},{header:"Disc",key:"discount",width:"w-24",align:"right",renderCell:e=>t.jsx(a,{amount:Number(e.discount)})},{header:"Total",key:"total",width:"w-32",align:"right",renderCell:e=>t.jsx(a,{amount:Number(e.total)})}]};function p(e){let r=`/admin/sales-detail-report/export/pdf?monthFrom=${e.monthFrom}&monthTo=${e.monthTo}`;return e.divisions&&e.divisions.length>0&&e.divisions.forEach((i,o)=>{r+=`&divisions[${o}][id]=${i.id}`}),e.customer_id&&(r+=`&customer_id=${e.customer_id}`),r}function g(e){let r=`/admin/sales-detail-report/export/excel?monthFrom=${e.monthFrom}&monthTo=${e.monthTo}`;return e.divisions&&e.divisions.length>0&&e.divisions.forEach((i,o)=>{r+=`&divisions[${o}][id]=${i.id}`}),e.customer_id&&(r+=`&customer_id=${e.customer_id}`),r}return t.jsx(j,{title:"Laporan Penjualan Detail",description:"Transaksi penjualan beserta detail item, filter berdasarkan periode, divisi, dan pelanggan",fetchUrl:"/admin/sales-detail-report/list",exportPdfUrl:p,exportExcelUrl:g,initialFilters:u,renderFilter:(e,r,i)=>t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-4 items-end",children:[t.jsx("div",{className:"lg:col-span-4",children:t.jsx(n,{label:"Divisi",children:t.jsx(k,{selectedDivisions:l||[],onSelectionChange:o=>{r({...e,divisions:o.map(x=>({id:x.id}))}),m(o)}})})}),t.jsx("div",{className:"lg:col-span-4",children:t.jsx(n,{label:"Pelanggan",children:t.jsx(w,{value:e.customer,onChange:o=>r({...e,customer:o,customer_id:o==null?void 0:o.id}),clearable:!0})})}),t.jsx("div",{className:"lg:col-span-2",children:t.jsx(n,{label:"Dari Bulan",children:t.jsx(d,{type:"month",value:e.monthFrom,onChange:o=>r({...e,monthFrom:o.target.value})})})}),t.jsx("div",{className:"lg:col-span-2",children:t.jsx(n,{label:"Hingga Bulan",children:t.jsx(d,{type:"month",value:e.monthTo,onChange:o=>r({...e,monthTo:o.target.value})})})}),t.jsx("div",{className:"lg:col-span-12 flex justify-end gap-2 mt-4",children:t.jsxs(v,{onClick:i,className:"bg-blue-600 hover:bg-blue-700",children:[t.jsx(C,{className:"h-4 w-4 mr-2"})," Tampilkan"]})})]}),columns:c,detailInline:h})}N.layout=l=>t.jsx(y,{breadcrumbs:[{label:"Dashboard",href:"/admin"},{label:"Laporan",href:"#"},{label:"Penjualan Detail",href:"#"}],children:l});export{N as default};
