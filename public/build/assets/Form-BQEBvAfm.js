import{W as z,r as b,j as e,y as F}from"./app-xdIDsNuc.js";import{B as p}from"./index-D9fYs-5N.js";import{C as L,a as M,b as K,c as O,d as V}from"./card-DPe-xeUS.js";import{F as i}from"./form-group-DJppTG6k.js";import{I as c}from"./input-Pb5O0huv.js";import{t as g}from"./use-toast-BOfnQU58.js";import{I as W}from"./ImageUploader-r4l5jz7T.js";import{T as $,a as R,b as U,c as Y}from"./tabs-Be33VXZ5.js";import{P as C}from"./plus-g40r8l_n.js";import{T as N}from"./trash-2-DreEqKRe.js";import"./utils-jM7Hu9J5.js";import"./label-DxiqzSVl.js";import"./createLucideIcon-D9qBrcbq.js";import"./x-Cp6Dz_ky.js";import"./check-B2a_CU3u.js";import"./index-CltWYr8P.js";import"./index-OwxvCaeV.js";import"./index-4rFdga_w.js";import"./index-CZTB0vk4.js";function pe({initialData:u={code:"",name:"",image:"",how_to_pay:[]},onSubmit:w,submitButtonText:j,successMessage:k,redirectTo:T}){const{data:o,setData:d,clearErrors:P,errors:m,setError:S}=z({...u}),[y,v]=b.useState(!1),[l,n]=b.useState(((u==null?void 0:u.how_to_pay)||[]).map(a=>({channel:a.channel||"",steps:a.steps||[]}))),[f,x]=b.useState(l.length>0?"0":"");async function _(){var a,s,r;P(),v(!0);try{await w({...o,how_to_pay:l}),g({title:"Sukses",description:k}),F.visit(T)}catch(t){if(((a=t.response)==null?void 0:a.status)===422){const h=t.response.data.errors;S(h)}else g({variant:"destructive",title:"Gagal",description:((r=(s=t.response)==null?void 0:s.data)==null?void 0:r.message)||"Terjadi kesalahan"})}finally{v(!1)}}const B=()=>{const a={channel:"",steps:[]},s=[...l,a];n(s),x(String(s.length-1))},H=a=>{const s=l.filter((r,t)=>t!==a);n(s),f===String(a)&&x(s.length>0?"0":"")},G=(a,s)=>{const r=[...l];r[a].channel=s,n(r)},A=a=>{const s=[...l];s[a].steps=[...s[a].steps||[],""],n(s)},E=(a,s)=>{const r=[...l];r[a].steps=(r[a].steps||[]).filter((t,h)=>h!==s),n(r)},q=(a,s,r)=>{const t=[...l];t[a].steps||(t[a].steps=[]),t[a].steps[s]=r,n(t)};return e.jsx("div",{className:"p-5",children:e.jsxs(L,{children:[e.jsxs(M,{children:[e.jsx(K,{children:"Form Metode Pembayaran"}),e.jsx(O,{children:"Isikan data metode pembayaran dengan benar"})]}),e.jsxs(V,{children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-2",children:e.jsx(i,{label:"Grup",error:m.group,required:!0,children:e.jsx(c,{type:"text",value:o.group||"",onChange:a=>{d("group",a.target.value)},placeholder:"Contoh: Bank, E-Wallet, dll"})})}),e.jsx(i,{label:"Kode",error:m.code,required:!0,children:e.jsx(c,{type:"text",value:o.code||"",onChange:a=>{d("code",a.target.value)},placeholder:"Contoh: BCA, GOPAY, OVO"})}),e.jsx(i,{label:"Nama",error:m.name,required:!0,children:e.jsx(c,{type:"text",value:o.name||"",onChange:a=>{d("name",a.target.value)},placeholder:"Contoh: Bank Central Asia"})}),e.jsx(i,{label:"Biaya Transaksi",error:m.transaction_fee,required:!0,children:e.jsx(c,{type:"number",value:o.transaction_fee||"",onChange:a=>{d("transaction_fee",a.target.value?parseInt(a.target.value):0)},placeholder:"Contoh: 5000"})})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 mt-4",children:[e.jsx(i,{label:"Gambar/Icon",error:m.image,children:e.jsx(W,{maxHeight:300,label:"",initialValue:o.image,onSuccess:a=>{d("image",a),g({title:"Sukses",description:"Gambar berhasil diunggah"})},onError:a=>{g({variant:"destructive",title:"Gagal",description:a})}})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Cara Pembayaran"}),e.jsxs(p,{size:"sm",onClick:B,type:"button",children:[e.jsx(C,{className:"w-4 h-4 mr-2"}),"Tambah Channel"]})]}),l.length===0?e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:e.jsx("p",{className:"text-gray-500",children:"Belum ada channel pembayaran. Klik tombol di atas untuk menambahkan."})}):e.jsxs($,{value:f,onValueChange:x,className:"w-full",children:[e.jsx(R,{className:"grid w-full gap-2 grid-flow-col overflow-x-auto justify-start h-auto",children:l.map((a,s)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{value:String(s),children:a.channel||`Channel ${s+1}`}),l.length>1&&e.jsx(p,{size:"sm",variant:"ghost",onClick:()=>H(s),type:"button",className:"h-8 w-8 p-0",children:e.jsx(N,{className:"w-3 h-3"})})]},s))}),l.map((a,s)=>e.jsxs(Y,{value:String(s),className:"space-y-4 mt-4",children:[e.jsx(i,{label:"Nama Channel",required:!0,children:e.jsx(c,{type:"text",value:a.channel||"",onChange:r=>G(s,r.target.value),placeholder:"Contoh: ATM, Mobile Banking, Teller"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("label",{className:"block text-sm font-semibold",children:"Langkah Pembayaran"}),e.jsxs(p,{size:"sm",onClick:()=>A(s),type:"button",children:[e.jsx(C,{className:"w-4 h-4 mr-2"}),"Tambah Langkah"]})]}),!a.steps||a.steps.length===0?e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:e.jsx("p",{className:"text-gray-500 text-sm",children:"Belum ada langkah. Klik tombol di atas untuk menambahkan."})}):e.jsx("div",{className:"space-y-2",children:a.steps.map((r,t)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-3 flex gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("label",{className:"block text-xs font-semibold text-gray-600 mb-1",children:["Langkah ",t+1]}),e.jsx(c,{type:"text",value:r,onChange:h=>q(s,t,h.target.value),placeholder:"Contoh: Buka aplikasi BCA..."})]}),e.jsx("div",{className:"flex items-center",children:e.jsx(p,{size:"sm",variant:"destructive",onClick:()=>E(s,t),type:"button",className:"h-9",children:e.jsx(N,{className:"w-4 h-4"})})})]},t))})]})]},s))]})]})]}),e.jsx(p,{onClick:_,disabled:y,className:"mt-6",children:y?`${j}...`:j})]})]})})}export{pe as default};
