import{W as y,r as m,j as t,a as l,y as M}from"./app-CQ-G37p-.js";import{h as V}from"./moment-C5S46NFB.js";import{t as b}from"./use-toast-XJEkqv7A.js";import"./lodash-Caeo88pO.js";import{A as q}from"./AuthenticatedLayout-X6euxa7E.js";import{B as S}from"./button-ymMXdPy5.js";import{I as u}from"./input-BXXA-PDa.js";import"./money-input-Bb590VQ4.js";import{F as o}from"./form-group-CHZXn8bM.js";import{S as G}from"./select-remote-C3ahzpc3.js";import{T as L}from"./textarea-BvykTLwI.js";import{S as R}from"./SearchDivision-Budjprvk.js";import{S as U}from"./SearchVendor-DVTa9TJs.js";import $ from"./PurchaseOrderItemForm-C6OyA6bu.js";import J from"./PurchaseOrderTotal-D_pIvllm.js";import W from"./PurchaseOrderItemList-DfCcsB2y.js";import{P as z}from"./plus-gEoqNGty.js";import"./index-D0iIn24t.js";import"./createLucideIcon-iWXofaGH.js";import"./index-DqZ46QiR.js";import"./index-BHS3gC_j.js";import"./index-B9C1SM0Q.js";import"./tslib.es6-eMSY344_.js";import"./index-uJ2KZHf0.js";import"./x-D2Pel9EU.js";import"./index-C7S3ohsj.js";import"./index-B9VoEdXn.js";import"./can-DARgw7Bo.js";import"./chevron-right-DWL5tPD-.js";import"./badge-CsIJHFj0.js";import"./currency-formatter-D5vTOkIG.js";import"./triangle-alert-byTh5Szo.js";import"./calendar-BV_-Gsoc.js";import"./label-Blk7FhF1.js";import"./select-BSIJzAmS.js";import"./index-CZ_DqijM.js";import"./chevron-down-BOk5s691.js";import"./index-CwCPKFMf.js";import"./search-B9EA-nRY.js";import"./card-Bq41eL_q.js";import"./loader-circle-i2ANfqrZ.js";import"./SearchChartOfAccount-0Jd4yGJY.js";import"./file-text-vhY6aTSF.js";import"./SearchItem-DGpcvLrN.js";import"./package-Cd0mGsRo.js";import"./SearchSubUnit-CTrUekdR.js";import"./dialog-CBBIkam9.js";import"./auto-manual-toggle-Drq7Gsew.js";import"./settings-BIxmfjj-.js";import"./EmptyTable-CjEJGtgb.js";import"./table-BSdxGOLt.js";import"./pencil-XLeJOTln.js";import"./trash-C6VGYEst.js";function H({division:h,purchaseOrder:C}){var _,v,g,j;const{data:r,setData:a,errors:i,setError:E,clearErrors:I}=y(C),[P,f]=m.useState(!1),{data:d,setData:c}=y({is_stock:!0}),[D,x]=m.useState({}),[k,T]=m.useState();m.useEffect(()=>{async function e(){const s=await l.get(`/admin/type-of-tax/${r.type_of_tax_id}`);T(s.data.data)}e()},[r.type_of_tax_id]);const[n,p]=m.useState({open:!1,isEdit:!1,index:0}),N=async()=>{try{return await l.post("/admin/purchase-order/validate",d),x({}),!0}catch(e){return x(e.response.data.errors),!1}},O=async()=>{if(await N()){if(n.isEdit){const e=r.items;e[n.index]=d,a({...r,items:e})}else a("items",[...r.items,d]);p({...n,open:!1})}},w=async()=>{f(!0),I();try{await l.put(`/admin/purchase-order/${r.id}`,{...r,date:V(r.date).format("YYYY-MM-DD")}),M.visit("/admin/purchase-order"),b({title:"Berhasil",description:"Purchase order berhasil diubah"})}catch(e){e.response.status==422?E(e.response.data.errors):b({variant:"destructive",title:"Gagal",description:e.response.data.message})}finally{f(!1)}},F=()=>{c({item_id:"",item:{code:"",name:""},chart_of_account_id:"",chart_of_account:{code:"",name:""},price:"0",quantity:"0",subtotal:"0",discount_percent:0,discount:"0",notes:"",is_stock:!0}),p({open:!0,isEdit:!1,index:0})},Y=(e,s)=>{c(s),p({open:!0,isEdit:!0,index:e})},A=e=>{var s;a({...r,items:(s=r.items)==null?void 0:s.filter((K,B)=>e!=B)})};return t.jsxs("div",{className:"pt-5  px-5",children:[t.jsxs("div",{className:"grid grid-cols-3 gap-x-4  gap-y-4",children:[t.jsx(o,{label:"Divisi",error:i.division_id,name:"division_id",children:t.jsx(R,{value:{id:r.division_id,code:(_=r.division)==null?void 0:_.code,name:(v=r.division)==null?void 0:v.name},onChange:e=>{a({...r,division_id:e.id,division:{id:e.id,code:e.code,name:e.name}})}})}),t.jsx(o,{label:"Vendor",error:i.vendor_id,name:"vendor_id",children:t.jsx(U,{value:{id:r.vendor_id,code:(g=r.vendor)==null?void 0:g.code,name:(j=r.vendor)==null?void 0:j.name},onChange:e=>{a({...r,vendor_id:e.id,vendor:{id:e.id,code:e.code,name:e.name}})}})}),t.jsx(o,{label:"Jenis Pajak",error:i.type_of_tax_id,name:"type_of_tax_id",children:t.jsx(G,{value:r.type_of_tax_id,remoteConfig:{url:"/admin/type-of-tax/list",label:e=>e.name,value:e=>e.id.toString()},onValueChange:e=>{a({...r,type_of_tax_id:e})}})}),t.jsx(o,{label:"Tanggal",error:i.date,name:"date",children:t.jsx(u,{type:"date",value:r.date,onChange:e=>{a({...r,date:e.target.value})}})}),t.jsx(o,{label:"Nomor",error:i.number,name:"number",required:!0,children:t.jsx(u,{type:"text",value:r.number,disabled:!0,onChange:e=>{a({...r,number:e.target.value})}})}),t.jsx(o,{label:"UP",error:i.for_recipients,name:"for_recipients",children:t.jsx(u,{type:"text",value:r.for_recipients,onChange:e=>{a({...r,for_recipients:e.target.value})}})}),t.jsx("div",{className:"col-span-3",children:t.jsx(o,{label:"Catatan",error:i.remarks,name:"remarks",children:t.jsx(L,{value:r.remarks,onChange:e=>{a({...r,remarks:e.target.value})}})})}),t.jsxs("div",{className:"col-span-3",children:[t.jsx(W,{items:r.items,onEdit:Y,onDelete:A}),t.jsx(S,{className:"w-full",onClick:F,children:t.jsx(z,{})})]}),t.jsx("div",{className:"col-span-3",children:t.jsx(J,{data:r,type_ofTax:k,setData:a})})]}),t.jsx(S,{type:"button",onClick:w,children:P?"Mengubah...":"Ubah"}),t.jsx($,{formDialog:n,onOpenChange:()=>p({...n,open:!1}),data:d,setData:c,onSave:O,errors:D})]})}H.layout=h=>t.jsx(q,{breadcrumbs:[{label:"Dashboard",href:"/admin/"},{label:"Transaksi",href:"#"},{label:"Purchase Order",href:"/admin/purchase-order"},{label:"Edit",href:"#"}],children:h});export{H as default};
